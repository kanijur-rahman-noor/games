window.__require=function e(t,s,o){function i(c,r){if(!s[c]){if(!t[c]){var a=c.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!r&&l)return l(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var h=s[c]={exports:{}};t[c][0].call(h.exports,function(e){return i(t[c][1][e]||e)},h,h.exports,e,t,s,o)}return s[c].exports}for(var n="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({Accelerator:[function(e,t,s){"use strict";cc._RF.push(t,"849dbWoOXpA75e8e/M5iofG","Accelerator");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./MathModule"),{ccclass:n,property:c,requireComponent:r}=cc._decorator;let a=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.scale=1,this.isFlipping=!1,this.isDumping=!0,this.easing="",this.easeFunc=e=>e,this.dumpingSpeed=1,this.y=0,this.x=0,this.active=!1}onLoad(){this.easing&&this.setEasing(this.easing)}lateUpdate(){this.isDumping&&!this.active&&(this.x>Number.EPSILON||this.x<Number.EPSILON)&&this.by(0),this.active=!1}by(e){let t=Math.sign(e);return(t>0&&this.x<0||t<0&&this.x>0)&&this.isFlipping&&(this.x=0),0===e&&(e=cc.director.getDeltaTime()*this.dumpingSpeed),this.x=i.default.moveTowards(this.x,t,Math.abs(e)),this.y=this.easeFunc(Math.abs(this.x))*this.scale*Math.sign(this.x),this.active=!0,this.y}setEasing(e){"string"==typeof e?""!==e&&(this.easeFunc=cc.easing[e]||this.easeFunc):this.easeFunc=e}};return o([c],e.prototype,"scale",void 0),o([c],e.prototype,"isFlipping",void 0),o([c],e.prototype,"isDumping",void 0),o([c(cc.String)],e.prototype,"easing",void 0),o([n],e)})();s.default=a,cc._RF.pop()},{"./MathModule":"MathModule"}],Arena:[function(e,t,s){"use strict";cc._RF.push(t,"0fb50lDO05BMbuJOKqiZjqH","Arena");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Level"),n=e("./Game"),c=e("./Gameplay"),{ccclass:r,property:a,executionOrder:l,disallowMultiple:h}=cc._decorator;let d=(()=>{var e;let t=e=class extends cc.Component{constructor(){super(...arguments),this.level=null,this.levelsPath="",this.isReady=!1,this.keyName="Arena",this.sd={}}static get instance(){return e._instance}onLoad(){this.level.arena=this,this.readSaveData()}onEnable(){e._instance&&e._instance!==this&&e._instance.disable(),e._instance=this,this.level.arena=this,this.startGame()}enable(){this.node.active?this.onEnable():this.node.active=!0}loadLevelHandler(e,t){cc.log("%%%%%% sender "+typeof e),cc.log("%%%%%% data "+t),this.loadLevel(t)}loadLevel(e){e&&this.level&&this.level.node.name!==e?cc.loader.loadRes(this.levelsPath+e,cc.Prefab,(e,t)=>{if(e)return void cc.error(e.message||e);let s=cc.instantiate(t);if(s){let e=s.getComponent(i.default);e.arena=this,s.setParent(this.level.node.parent),cc.loader.releaseRes(this.levelsPath+this.level.node.name,cc.Prefab),this.level.node.destroy(),this.level=e,cc.log("load new level "+this.level.node.name),this.enable()}}):this.level&&(cc.log("load same level"),this.enable())}startGame(){this.node.opacity=255,this.isReady=!1,this.level.reset(),this.node.emit("started"),c.default.instance.gameStart()}readyGame(){this.isReady||(this.level.ready(),this.isReady=!0)}restartGame(){this.startGame()}failGame(){this.isReady=!1,this.level.fail()}finishGame(){this.isReady=!1,this.level.finish(),this.node.emit("finished")}endGame(){this.level.end(),this.writeSaveData(),this.disable(),c.default.instance.gameEnd()}disable(){this.node.active?this.node.active=!1:this.onDisable()}onDisable(){}onPause(){this.node.opacity=0,this.node.emit("paused")}onResume(){this.node.opacity=255,this.node.emit("resumed")}readSaveData(){this.sd=n.default.instance.progressData[this.keyName]||this.sd}writeSaveData(){n.default.instance.progressData[this.keyName]=this.sd}};return t._instance=null,o([a(i.default)],t.prototype,"level",void 0),o([a(cc.String)],t.prototype,"levelsPath",void 0),e=o([r,l(-10),h],t)})();s.default=d,cc._RF.pop()},{"./Game":"Game","./Gameplay":"Gameplay","./Level":"Level"}],BackgroundGrad:[function(e,t,s){"use strict";cc._RF.push(t,"9d038PmbO9FQKZrExjirby7","BackgroundGrad");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Game"),{ccclass:n,property:c}=cc._decorator;let r=(()=>{var e;let t=e=class extends cc.Component{constructor(){super(...arguments),this.nodes=[],this.sd={}}onLoad(){e._instance=this,this.nodes=this.node.children,this.readSaveData()}moveY(e){if(0!==e&&this.nodes.length)for(let t of this.nodes)t.y+=e,e>0&&t.y>this.node.height+t.height/2*t.scaleY?t.y-=t.height*t.scaleY*this.nodes.length:e<0&&t.y<-t.height/2*t.scaleY&&(t.y+=t.height*t.scaleY*this.nodes.length)}readSaveData(){if(this.sd=i.default.instance.progressData.Background,this.sd)for(let e of this.nodes)e.y=this.sd[e.name].y}writeSaveData(){this.sd||(this.sd={});for(let e of this.nodes)this.sd[e.name]={y:e.y};i.default.instance.progressData.Background=this.sd}};return t._instance=null,o([c(cc.Node)],t.prototype,"nodes",void 0),e=o([n],t)})();s.default=r,cc._RF.pop()},{"./Game":"Game"}],BallSpawner:[function(e,t,s){"use strict";cc._RF.push(t,"490adJp4NlO55W0+txkXtKs","BallSpawner");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.ballPrefab=null,this.mask=null,this.spawnAudio=null}start(){this.node.scale=0}spawn(e){var t=cc.instantiate(this.ballPrefab);t.parent=this.mask,t.setPosition(cc.v2(0,this.mask.height/2+t.height)),t.active=!1,cc.tween(this.node).set({scale:0}).delay(.5).call(()=>{this.spawnAudio&&cc.audioEngine.playEffect(this.spawnAudio,!1)}).to(.5,{scale:1},{easing:"backOut"}).call(()=>{t.active=!0,cc.tween(t).to(.8,{y:0},null).call(()=>{t.setParent(this.node.parent),t.setPosition(this.node.position),e(t)}).start()}).delay(1).to(.5,{scale:0},{easing:"quadIn"}).start()}};return o([n(cc.Prefab)],e.prototype,"ballPrefab",void 0),o([n(cc.Node)],e.prototype,"mask",void 0),o([n({type:cc.AudioClip})],e.prototype,"spawnAudio",void 0),o([i],e)})();s.default=c,cc._RF.pop()},{}],Ball:[function(e,t,s){"use strict";cc._RF.push(t,"877a5z2v4hEG708+x7JqKrj","Ball");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Hole"),{ccclass:n,property:c}=cc._decorator;let r=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.destroyParticle=null,this.spawnAudio=null,this.removeAudio=null,this.touchAudio=null,this.rb=null,this.cpcol=null,this.spawnTween=null,this.destroyTween=null,this.isReady=!1,this.canBeCaught=!0,this.level=null}get radius(){return this.cpcol.radius}onLoad(){this.rb=this.getComponent(cc.RigidBody),this.cpcol=this.getComponent(cc.PhysicsCircleCollider),this.spawnTween=cc.tween(this.node).set({scale:0}).to(.5,{scale:1},null).call(()=>{this.onSpawned()}),this.destroyTween=cc.tween(this.node).to(.5,{scale:0},null).delay(.3).call(()=>{this.onRemoved()})}start(){this.node.scaleX=0,this.spawn()}spawn(){this.spawnTween.start(),this.playAudio(this.spawnAudio),this.isReady=!1}remove(){this.isReady=!1,this.rb.destroy(),this.destroyTween.start(),this.playAudio(this.removeAudio)}onSpawned(){console.log("--------------ball Spawned"),this.rb.awake=!0,this.rb.active=!0}onRemoved(){this.level.ballRemoved(this),this.node.destroy()}playAudio(e){e&&cc.audioEngine.playEffect(e,!1)}onDestroy(){console.log("-------------Ball destroyed")}onCollisionEnter(e,t){this.isReady&&this.canBeCaught&&"hole"===e.node.group&&0===t.tag&&0===e.tag&&(this.isReady=!1,e.getComponent(i.default).captureBall(this),this.level.ballCaptured(this),console.log("hole collision enter with "+e.name))}onBeginContact(e,t,s){if("platform"===s.node.group)this.isReady||(this.isReady=!0,this.playAudio(this.touchAudio),this.level.ballReady());else if("ground"===s.node.group&&(this.remove(),0===s.tag)){let e=cc.instantiate(this.destroyParticle);e.setParent(this.node.parent),e.position=this.node.position,console.log("particle instantiated at "+e.parent)}}};return o([c(cc.Prefab)],e.prototype,"destroyParticle",void 0),o([c({type:cc.AudioClip})],e.prototype,"spawnAudio",void 0),o([c({type:cc.AudioClip})],e.prototype,"removeAudio",void 0),o([c({type:cc.AudioClip})],e.prototype,"touchAudio",void 0),o([n],e)})();s.default=r,cc._RF.pop()},{"./Hole":"Hole"}],Block:[function(e,t,s){"use strict";cc._RF.push(t,"639bek9hCxKybFtOPKxHPiY","Block");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./MathModule"),n=e("./Accelerator"),{ccclass:c,property:r,requireComponent:a}=cc._decorator;let l=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.rotationSpeed=0,this.rotaionConstraint=0,this.moveSpeed=0,this.moveDelta=0,this.moveEasing="",this.rotEasing="",this.streakNode=null,this.moveAcc=null,this.rotAcc=null,this.rb=null,this.level=null,this.spawnTween=null,this.removeTween=null,this.startY=0}onLoad(){this.rb=this.getComponent(cc.RigidBody),this.spawnTween=cc.tween(this.node).set({scaleX:0}).to(.5,{scaleX:1},{easing:"quadOut"}),this.removeTween=cc.tween(this.node).to(.5,{scaleX:0},{easing:"quadIn"}),this.startY=this.node.y,this.moveAcc=this.node.addComponent(n.default),this.rotAcc=this.node.addComponent(n.default),this.moveAcc.isFlipping=!0,this.moveAcc.dumpingSpeed=4,this.rotAcc.isFlipping=!0,this.moveAcc.setEasing(this.moveEasing),this.rotAcc.setEasing(this.rotEasing)}start(){this.node.scaleX=0,this.streakNode.scaleY=0,this.streakNode.zIndex=-1}update(){this.level.isRun&&(this.streakNode.scaleY=this.moveAcc.y)}spawn(){this.reset(),this.spawnTween.start()}remove(){this.removeTween.start()}reset(){this.node.angle=0,this.node.y=this.startY,this.streakNode.scaleY=0}moveBy(e){this.node.y=i.default.clamp(this.node.y+this.moveAcc.by(e)*this.moveSpeed*cc.director.getDeltaTime(),this.startY-this.moveDelta,this.startY+this.moveDelta)}tiltBy(e){this.node.angle=i.default.clamp(this.node.angle+this.rotAcc.by(e)*this.rotationSpeed*cc.director.getDeltaTime(),-this.rotaionConstraint,this.rotaionConstraint),this.onTilt()}tiltTo(e){this.node.angle=i.default.clamp(i.default.moveTowards(this.node.angle,this.rotaionConstraint*e,this.rotationSpeed*cc.director.getDeltaTime()),-this.rotaionConstraint,this.rotaionConstraint),this.onTilt()}onTilt(){this.streakNode.skewX=this.node.angle}};return o([r],e.prototype,"rotationSpeed",void 0),o([r({min:0,max:45})],e.prototype,"rotaionConstraint",void 0),o([r],e.prototype,"moveSpeed",void 0),o([r],e.prototype,"moveDelta",void 0),o([r(cc.String)],e.prototype,"moveEasing",void 0),o([r(cc.String)],e.prototype,"rotEasing",void 0),o([r(cc.Node)],e.prototype,"streakNode",void 0),o([c],e)})();s.default=l,cc._RF.pop()},{"./Accelerator":"Accelerator","./MathModule":"MathModule"}],CollisionHandler:[function(e,t,s){"use strict";cc._RF.push(t,"30d57wMgftNzbiuWlPRBJ1D","CollisionHandler");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n,requireComponent:c}=cc._decorator;let r=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.otherGroup="",this.onEnterEvents=[],this.onStayEvents=[],this.onExitEvents=[]}onLoad(){}onCollisionEnter(e,t){this.otherGroup&&e.node.group!==this.otherGroup||this.onEnterEvents.forEach(e=>e.emit(null))}onCollisionStay(e,t){this.otherGroup&&e.node.group!==this.otherGroup||this.onEnterEvents.forEach(e=>e.emit(null))}onCollisionExit(e,t){this.otherGroup&&e.node.group!==this.otherGroup||this.onEnterEvents.forEach(e=>e.emit(null))}};return o([n(cc.String)],e.prototype,"otherGroup",void 0),o([n(cc.Component.EventHandler)],e.prototype,"onEnterEvents",void 0),o([n(cc.Component.EventHandler)],e.prototype,"onStayEvents",void 0),o([n(cc.Component.EventHandler)],e.prototype,"onExitEvents",void 0),o([i,c(cc.Collider)],e)})();s.default=r,cc._RF.pop()},{}],ColorToggler:[function(e,t,s){"use strict";cc._RF.push(t,"f51bdSuhJVDfL5f/jZMPyqS","ColorToggler");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.target=null,this.onColor=cc.Color.WHITE,this.offColor=cc.Color.WHITE,this.duration=.1,this.isOn=!0,this.onTween=null,this.offTween=null}onLoad(){this.onTween=cc.tween(this.target).to(this.duration,{color:this.onColor},null),this.offTween=cc.tween(this.target).to(this.duration,{color:this.offColor},null)}toggle(){this.isOn?this.toggleOff():this.toggleOn()}toggleOn(){this.onTween&&(this.offTween&&this.offTween.stop(),this.onTween.start())}toggleOff(){this.offTween&&(this.onTween&&this.onTween.stop(),this.offTween.start())}};return o([n(cc.Node)],e.prototype,"target",void 0),o([n(cc.Color)],e.prototype,"onColor",void 0),o([n(cc.Color)],e.prototype,"offColor",void 0),o([n],e.prototype,"duration",void 0),o([i],e)})();s.default=c,cc._RF.pop()},{}],ContentFitter:[function(e,t,s){"use strict";cc._RF.push(t,"cfef0p376xInZFcPUrRqwBP","ContentFitter");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n,executeInEditMode:c}=cc._decorator;let r=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.label=null}onLoad(){this.label=this.getComponent(cc.Label)}start(){}};return o([i,c],e)})();s.default=r,cc._RF.pop()},{}],EndlessArena:[function(e,t,s){"use strict";cc._RF.push(t,"85f6e9JeYlOrpd7dO1+c2hh","EndlessArena");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Arena"),n=e("./UI/NavigationPanel"),c=e("./Game"),{ccclass:r,property:a,executionOrder:l,disallowMultiple:h}=cc._decorator;let d=(()=>{let e=class extends i.default{constructor(){super(...arguments),this.uiNode=null,this.scorePanel=null,this.summaryPanel=null,this.scoreLabel=null,this.bestScoreLabel=null,this.gemsLabel=null,this.keyName="EndlessArena",this.gems=0}onLoad(){super.onLoad()}lateUpdate(){this.level.isRun&&this.setScoreLabel(this.level.score)}startGame(){super.startGame(),this.gems=0,this.resetUI()}readyGame(){super.readyGame(),this.readyUI()}failGame(){this.finishGame()}finishGame(){super.finishGame(),c.default.instance.progressData.EndlessArena.gems+=this.gems,this.showSummaryUI()}endGame(){this.closeUI(),super.endGame()}onPause(){super.onPause(),this.hideUI()}onResume(){super.onResume(),this.showUI()}onGemPicked(){++this.gems,this.gemsLabel.string=this.gems+""}resetUI(){this.showUI(),this.scorePanel.hide(),this.summaryPanel.close(),this.setScoreLabel(this.level.score)}readyUI(){this.scorePanel.show()}showSummaryUI(){this.summaryPanel.openNext(),this.scoreLabel.string=this.level.sd.score+"m",this.setBestScoreLabel(this.level.sd.bestScore)}closeUI(){this.scorePanel.hide(),this.summaryPanel.close()}setScoreLabel(e){this.scoreLabel.string=e+""}setBestScoreLabel(e){this.bestScoreLabel.string=e+"m"}hideUI(){this.uiNode.active=!1}showUI(){this.uiNode.active=!0}};return o([a(cc.Node)],e.prototype,"uiNode",void 0),o([a(n.default)],e.prototype,"scorePanel",void 0),o([a(n.default)],e.prototype,"summaryPanel",void 0),o([a(cc.Label)],e.prototype,"scoreLabel",void 0),o([a(cc.Label)],e.prototype,"bestScoreLabel",void 0),o([a(cc.Label)],e.prototype,"gemsLabel",void 0),o([r,l(-10),h],e)})();s.default=d,cc._RF.pop()},{"./Arena":"Arena","./Game":"Game","./UI/NavigationPanel":"NavigationPanel"}],EndlessLevel:[function(e,t,s){"use strict";cc._RF.push(t,"ba3fff4enFFHaEs3GSqpnVF","EndlessLevel");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Level"),n=e("./RandomHoleField"),c=e("./Gameplay"),{ccclass:r,property:a}=cc._decorator;let l=(()=>{let e=class extends i.default{constructor(){super(...arguments),this.holeFields=[],this.meterScale=10,this.maxSpeed=10,this.ground=null,this.bestLine=null,this.lastLine=null,this.lastLineLabel=null,this.bestLineLabel=null,this.arena=null,this.groundY=0,this.groundSpeed=0,this.scoreCounter=0,this.startSpeed=0,this.onLiftUp=(()=>{var e=0,t=()=>{this.moveBy(4)};return s=>(e+=s)<=0?(this.unschedule(t),null):t})(),this.minorChecks=1,this.midChecks=1,this.majorChecks=1,this.funcInvokeData={default:{name:"",count:0}}}onLoad(){super.onLoad(),this.groundSpeed=this.speed/2,this.groundY=this.ground.y,this.startSpeed=this.speed,this.node.on("powerup",this.powerUpHandler,this)}reset(){super.reset(),this.speed=this.startSpeed,this.scoreCounter=0,cc.tween(this.ground).set({y:-this.node.height/2}).to(.5,{y:this.groundY},null).start(),this.hideRecordLines(),this.resetProgress()}ready(){super.ready(),this.setRecordLines()}run(){super.run(),this.schedule(this.progressChecker,.2)}fail(){this.finish()}finish(){super.finish(),this.unschedule(this.progressChecker),cc.tween(this.ground).to(.5,{y:-this.node.height/2},null).start(),this.hideRecordLines()}update(e){super.update(e),!c.default.paused&&this.isRun&&this.isReady&&(this.ground.y+=this.groundSpeed*e-this.dyt*this.speed,this.ground.y=cc.misc.clampf(this.ground.y,-this.node.height/2-100,0),0!==this.dyt&&(this.scoreCounter+=this.dyt*this.speed,this.scoreCounter>=0&&(this.score=Math.floor(this.scoreCounter/this.meterScale))))}moveFieldBy(e){for(let t of this.holeFields)t.node.y+=e*this.speed*this.moveDir,e>0&&t.node.y<-this.node.height/2-t.node.height/2&&(t.node.y+=t.node.height*this.holeFields.length,t.clear(),t.spawn(),console.log("treshhold down"))}onGemPicked(){this.arena.onGemPicked()}powerUpHandler(e){switch(cc.log("powerup handler"),e){case"liftUp":cc.log("on lift up");let t=cc.tween(this.ball.node).repeat(4,cc.tween().to(.3,{opacity:128},null).to(.3,{opacity:255},null)).call(()=>{this.ball.canBeCaught=!0});cc.tween(this.node).call(()=>{this.ball.canBeCaught=!1,this.canMove=!1,t.stop(),this.schedule(this.onLiftUp(1),0)}).delay(1).call(()=>{null===this.onLiftUp(-1)&&(t.start(),this.canMove=!0)}).start()}}setRecordLines(){this.sd.score&&(this.lastLine.active=!0,this.lastLine.y=this.sd.score*this.meterScale),this.sd.bestScore&&this.sd.bestScore!==this.sd.score&&(this.bestLine.active=!0,this.bestLine.y=this.sd.bestScore*this.meterScale),this.setRecordLinesLabel()}hideRecordLines(){this.lastLine.active=this.bestLine.active=!1}setRecordLinesLabel(){this.lastLineLabel.string=this.sd.score+"m",this.bestLineLabel.string=this.sd.bestScore+"m"}resetProgress(){this.minorChecks=this.midChecks=this.majorChecks=1,this.funcInvokeData={default:{name:"",count:0}}}progressChecker(){this.score>=1e3*this.majorChecks?(this.onMajorCheck(),this.majorChecks++,this.midChecks++,this.minorChecks++):this.score>=500*this.midChecks?(this.onMiddleCheck(),this.midChecks++):this.score>=250*this.minorChecks&&(this.onMinorCheck(),this.minorChecks++)}onMinorCheck(){let e,t=!1;do{t=(e=Math.random())<.3?this.funcInvokeLimiter(()=>{this.speedUp(20)},"speedUp20",2):e<.6?this.funcInvokeLimiter(()=>{this.speedUp(10)},"speedUp10",2):this.funcInvokeLimiter(this.fieldsRevealNewPowerUp,"revealPowerup",2)}while(!t)}onMiddleCheck(){let e,t=!1;do{t=(e=Math.random())<.5?this.funcInvokeLimiter(()=>{this.fieldsFillRateUp()},"fieldsFillRateUp",2):this.funcInvokeLimiter(()=>{this.speedUp(20)},"speedUp20",2)}while(!t)}onMajorCheck(){let e,t=!1;do{if(!((e=Math.random())<.8))break;t=this.funcInvokeLimiter(this.fieldsRevealNewHoles,"revealHole",2)}while(!t)}fieldsFillRateUp(){let e,t,s=!1;do{e=Math.floor(Math.random()*this.holeFields.length),t=.08*Math.random(),s=this.funcInvokeLimiter(()=>{this.holeFields[e].fillRateUp(t)},"holeFieldRateUp"+e,2,"holeFieldsFill")}while(!s)}fieldsRevealNewHoles(){let e,t=!1;do{e=Math.floor(Math.random()*this.holeFields.length),t=this.funcInvokeLimiter(()=>{this.holeFields[e].revealNextHole()},"holeFieldRevealHole"+e,2,"holeFieldsHoles")}while(!t)}fieldsRevealNewPowerUp(){let e,t=!1;do{e=Math.floor(Math.random()*this.holeFields.length),t=this.funcInvokeLimiter(()=>{this.holeFields[e].revealNextPowerUp()},"holeFieldRevealPowerup"+e,2,"holeFieldsPowerups")}while(!t)}speedUpByRate(e=.1){this.speed=cc.misc.clampf(this.speed+this.speed*e,0,this.maxSpeed)}speedUp(e=25){this.speed=cc.misc.clampf(this.speed+e,0,this.maxSpeed),cc.log("speed up by "+e)}funcInvokeLimiter(e,t,s,o="default"){let i=this.funcInvokeData[o];if(i||(this.funcInvokeData[o]=i={name:"",count:0}),t===i.name){if(!(i.count<s))return!1;e.call(this),i.count++}else e.call(this),i.name=t,i.count=1;return!0}};return o([a({type:n.default,override:!0})],e.prototype,"holeFields",void 0),o([a],e.prototype,"meterScale",void 0),o([a],e.prototype,"maxSpeed",void 0),o([a(cc.Node)],e.prototype,"ground",void 0),o([a(cc.Node)],e.prototype,"bestLine",void 0),o([a(cc.Node)],e.prototype,"lastLine",void 0),o([a(cc.Label)],e.prototype,"lastLineLabel",void 0),o([a(cc.Label)],e.prototype,"bestLineLabel",void 0),o([r],e)})();s.default=l,cc._RF.pop()},{"./Gameplay":"Gameplay","./Level":"Level","./RandomHoleField":"RandomHoleField"}],Gameplay:[function(e,t,s){"use strict";cc._RF.push(t,"dc694L36CxBhbWb/HREpMj1","Gameplay");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Arena"),{ccclass:n,property:c,executionOrder:r,disallowMultiple:a}=cc._decorator;let l=(()=>{var e;let t=e=class extends cc.Component{constructor(){return super(),this.gameStartEvents=[],this.gameEndEvents=[],e._instance||(e._instance=this)}static get instance(){return e._instance}onLoad(){cc.director.getPhysicsManager().gravity=cc.v2(0,-10),cc.game.on(cc.game.EVENT_HIDE,this.pauseGame,this),cc.game.on(cc.game.EVENT_SHOW,this.resumeGame,this)}startGame(){i.default.instance.enable()}pauseGame(){e.paused=!0,i.default.instance&&(this.enablePhysics(!1),i.default.instance.onPause())}resumeGame(){e.paused=!1,i.default.instance&&(this.enablePhysics(),i.default.instance.onResume())}restartGame(){i.default.instance.restartGame()}exitGame(){i.default.instance.endGame()}gameStart(){e.paused=!1,this.enablePhysics(),this.gameStartEvents.forEach(e=>e.emit(null))}gameEnd(){e.paused=!0,this.enablePhysics(!1),this.gameEndEvents.forEach(e=>e.emit(null))}enablePhysics(e=!0){cc.director.getPhysicsManager().enabled=e,cc.director.getPhysicsManager().gravity=cc.v2(0,-10),cc.director.getCollisionManager().enabled=e}};return t._instance=null,t.paused=!1,o([c(cc.Component.EventHandler)],t.prototype,"gameStartEvents",void 0),o([c(cc.Component.EventHandler)],t.prototype,"gameEndEvents",void 0),e=o([n,r(-11),a],t)})();s.default=l,cc._RF.pop()},{"./Arena":"Arena"}],Game:[function(e,t,s){"use strict";cc._RF.push(t,"9c833s2KXxEt5xmZM87JIWv","Game");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./BackgroundGrad"),n=e("./UI/SettingUI"),{ccclass:c,property:r,executionOrder:a,disallowMultiple:l}=cc._decorator;let h=(()=>{var e;let t=e=class extends cc.Component{constructor(){return super(),this.progressData={Background:null,EndlessArena:{gems:0},LevelsArena:{Level1:{score:0,bestScore:0}}},this.settings={sound:!0,music:!0,controls:{[d.Touch]:!1,[d.Keyboard]:!1,[d.Tilt]:!1}},e._instance||(e._instance=this)}static get instance(){return e._instance}onLoad(){this.loadSaveData(),window.addEventListener("beforeunload",()=>{console.log("window before unloaded"),this.writeSaveData()})}start(){n.default.instance.init()}onDestroy(){this.writeSaveData(),cc.log("game destroyed")}loadSaveData(){let e=cc.sys.localStorage.getItem("progressData"),t=cc.sys.localStorage.getItem("settings");e&&(this.progressData=JSON.parse(e)),t&&(this.settings=JSON.parse(t))}writeSaveData(){i.default._instance.writeSaveData(),cc.sys.localStorage.setItem("progressData",JSON.stringify(this.progressData)),cc.sys.localStorage.setItem("settings",JSON.stringify(this.settings)),cc.log("-=-=-write game savedata")}clearSaveData(){cc.sys.localStorage.removeItem("progressData"),cc.sys.localStorage.removeItem("settings")}exit(){this.writeSaveData(),cc.game.end()}};return t._instance=null,e=o([c,a(-15),l],t)})();var d;s.default=h,function(e){e[e.Keyboard=0]="Keyboard",e[e.Touch=1]="Touch",e[e.Tilt=2]="Tilt"}(d||(d={})),window.ControlType=d,cc._RF.pop()},{"./BackgroundGrad":"BackgroundGrad","./UI/SettingUI":"SettingUI"}],Gem:[function(e,t,s){"use strict";cc._RF.push(t,"ad63cipM0tFnqror1fgwQXV","Gem");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./SoundManager"),n=e("./Arena"),c=e("./EndlessArena"),{ccclass:r,property:a}=cc._decorator;let l=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.destroyParticle=null,this.pickSound=null}onLoad(){this.node.opacity=0}start(){cc.tween(this.node).to(.3,{opacity:255},null).start()}onCollisionEnter(e,t){if("ball"===e.node.group){if(this.destroyParticle){let e=cc.instantiate(this.destroyParticle);e.setParent(this.node.parent),e.setPosition(this.node.position)}i.default.playEffect(this.pickSound),this.node.destroy(),n.default.instance instanceof c.default&&n.default.instance.onGemPicked()}}};return o([a(cc.Prefab)],e.prototype,"destroyParticle",void 0),o([a({type:cc.AudioClip})],e.prototype,"pickSound",void 0),o([r],e)})();s.default=l,cc._RF.pop()},{"./Arena":"Arena","./EndlessArena":"EndlessArena","./SoundManager":"SoundManager"}],Globals:[function(e,t,s){"use strict";cc._RF.push(t,"a0de7T6CpVKnagYk6ULjEd/","Globals");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{let e=class extends cc.Component{onLoad(){}start(){}};return o([i],e)})();s.default=c,cc._RF.pop()},{}],GradientBg:[function(e,t,s){"use strict";cc._RF.push(t,"ddb2cooWIhMwKPk5WmxPU5N","GradientBg");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n,executeInEditMode:c}=cc._decorator,r=cc.Enum({Horizontal:0,Vertical:1});let a=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.colors=[cc.Color.WHITE,cc.Color.WHITE],this.dir=r.Horizontal,this.sprite=null,this.tex=null,this.pixFormat=cc.Texture2D.PixelFormat.RGBA8888}onLoad(){this.sprite=this.getComponent(cc.Sprite),this.tex=new cc.Texture2D,this.sprite.spriteFrame.setTexture(this.tex)}start(){this.setColors(...this.colors)}onFocusInEditor(){this.setColors(...this.colors)}setColors(...e){this.colors=e;let t=new Uint8Array(e.reduce((e,t)=>e.concat([t.getR(),t.getG(),t.getB(),t.getA()]),[]));switch(this.dir){case r.Horizontal:this.tex.initWithData(t,this.pixFormat,e.length,1);break;case r.Vertical:this.tex.initWithData(t,this.pixFormat,1,e.length)}}};return o([n([cc.Color])],e.prototype,"colors",void 0),o([n({type:r})],e.prototype,"dir",void 0),o([i,c],e)})();s.default=a,cc._RF.pop()},{}],GravityHole:[function(e,t,s){"use strict";cc._RF.push(t,"05b66iPuTdLB7JoQIxR05m7","GravityHole");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Hole"),{ccclass:n,property:c}=cc._decorator;let r=(()=>{let e=class extends i.default{constructor(){super(...arguments),this.gravityAcc=10}onCollisionStay(e,t){if(1===t.tag&&"ball"===e.node.group&&!this.isBallCaptured){let s=this.node.convertToWorldSpaceAR(cc.v2(0,0)).sub(e.node.convertToWorldSpaceAR(cc.v2(0,0))),o=(t.radius*this.node.scale+e.node.width-s.mag())*this.gravityAcc*this.node.scale,i=e.getComponent(cc.RigidBody);i&&i.applyForceToCenter(s.normalize().mul(o),!0)}}};return o([c],e.prototype,"gravityAcc",void 0),o([n],e)})();s.default=r,cc._RF.pop()},{"../Hole":"Hole"}],HoleField:[function(e,t,s){"use strict";cc._RF.push(t,"1a800LvIWdJvqJptvgVUf14","HoleField");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.rectNode=null,this.holesPool=[],this.activeHoles=[],this.done=!0,this.clearDone=!0}onLoad(){this.fillHPool(...this.rectNode.children),cc.log("-----pool filled length now "+this.holesPool.length)}fillHPool(...e){for(let t of e)"hole"===t.group?this.activeHoles.push(t):t.children&&this.fillHPool(...t.children)}reset(){this.clear()}clear(){if(this.activeHoles.length){for(let e of this.activeHoles)e.active=!1;this.holesPool=this.activeHoles.splice(0),this.clearDone=!0,console.log("_____field cleared "+this.node.name)}}setClear(){cc.Camera.main.containsNode(this.node)?(this.clearDone=!1,console.log("_____field cleared by anim "+this.node.name)):(this.clear(),console.log("_____field cleared by func "+this.node.name))}spawn(){if(this.holesPool.length){for(let e of this.holesPool)e.active=!0;this.activeHoles=this.holesPool.splice(0),this.done=!0,console.log("_____field spawned "+this.node.name)}}setSpawn(){cc.Camera.main.containsNode(this.node)?(this.done=!1,console.log("_____field spawned by anim "+this.node.name)):(this.spawn(),console.log("_____field spawned by func "+this.node.name))}update(){this.holeEmitter(),this.holeCleaner()}holeCleaner(){if(!this.clearDone&&this.done)if(this.activeHoles.length){let e=Math.floor(Math.random()*this.activeHoles.length),t=this.activeHoles.splice(e,1)[0];t.emit("remove"),this.holesPool.push(t)}else this.clearDone=!0}holeEmitter(){if(!this.done&&this.clearDone)if(this.holesPool.length){let e=Math.floor(Math.random()*this.holesPool.length),t=this.holesPool.splice(e,1)[0];t.emit("spawn",()=>{t.active=!0}),this.activeHoles.push(t)}else this.done=!0}};return o([n(cc.Node)],e.prototype,"rectNode",void 0),o([i],e)})();s.default=c,cc._RF.pop()},{}],HoleSpawner:[function(e,t,s){"use strict";cc._RF.push(t,"194e1XB689GZrfRpT/23F6Y","HoleSpawner");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.holePrefabs=null,this.cellSize=100,this.cellMargin=0,this.holeSample=null,this.rect=null,this.holes=[],this.actives=[],this.n=0,this.k=15,this.done=!1}onLoad(){this.rect=new cc.Rect(this.node.position.x-this.node.width*this.node.anchorX,this.node.position.y-this.node.height*this.node.anchorY,this.node.width,this.node.height),console.log("rect "+this.rect),this.node.on("touchstart",this.touchStart,this),this.pool=[[]]}start(){}reset(e){for(let t of this.node.children)t.parent=null;this.poolInd=[0],this.actives=[],this.holes=[],this.n=0,this.done=!1,this.spawnSample(this.getHoleSample(e))}update(e){this.emitter()}emitter(){if(!this.done&&this.n>0){let t=Date.now();do{let t=Math.floor(Math.random()*this.n)||0,s=this.actives[t];console.log("-----i = "+t+" hole = "+s+" length "+this.actives.length);for(var e=0;e<this.k;e++)this.generateAround(s);e===this.k&&(this.actives[t]=this.actives[--this.n],this.actives.pop())}while(this.n&&Date.now()-t<166);this.done=!0}}spawnSample(e){e.node.parent=this.node,this.actives.push(e),this.holes.push(e),this.n++,this.holeSample=null,console.log("sample spawned at pos "+e.node.position+" parent "+e.node.parent.name)}checkNear(e){new cc.Rect(e.node.position.x-e.node.width*e.node.anchorX,e.node.position.y-e.node.height*e.node.anchorY,e.node.width,e.node.height);let t=e.getComponent(cc.PhysicsCircleCollider).getAABB();console.log("aabb is "+t);let s=cc.director.getPhysicsManager().testAABB(t);return console.log("collided with "+s.length),s.length>0}checkExtent(e){let t=new cc.Rect(e.node.position.x-e.node.width*e.node.anchorX,e.node.position.y-e.node.height*e.node.anchorY,e.node.width,e.node.height);return this.rect.containsRect(t)}generateAround(e){}getHoleSample(e){return this.holeSample,e&&(this.holeSample.node.position=e),this.holeSample}touchStart(e){this.reset(e.getLocation())}};return o([n(cc.Prefab)],e.prototype,"holePrefabs",void 0),o([n],e.prototype,"cellSize",void 0),o([n],e.prototype,"cellMargin",void 0),o([i],e)})();s.default=c,cc._RF.pop()},{}],Hole:[function(e,t,s){"use strict";cc._RF.push(t,"e8b6fZqDX9CJbW1BeCA8kmL","Hole");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.radius=0,this.border=0,this.mask=null,this.isBallCaptured=!1,this.spawnTween=null,this.removeTween=null,this.lscale=0}onLoad(){this.spawnTween=cc.tween(this.node).set({scale:0}).to(.8,{scale:{value:this.node.scale,easing:"elasticOut"}},null),this.removeTween=cc.tween(this.node).to(.5,{scale:{value:0,easing:"quadIn"}},null),this.node.on("spawn",this.onSpawn,this),this.node.on("remove",this.onRemove,this),this.radius||(this.radius=Math.max(this.node.width,this.node.height)/2),0===this.lscale&&(this.lscale=this.node.scale)}onEnable(){this.isBallCaptured=!1}onDestroy(){this.node.off("spawn",this.onSpawn,this),this.node.off("remove",this.onRemove,this)}onSpawn(e){e&&e(),cc.tween(this.node).set({scale:0}).to(.8,{scale:{value:this.lscale,easing:"elasticOut"}},null).start(),this.isBallCaptured=!1}onRemove(e){this.removeTween.call(e).start()}captureBall(e){this.isBallCaptured=!0,e.node.setParent(this.node),0!=this.node.scale&&(e.node.scale=1/this.node.scale);let t=e.node.position.normalize().mul(this.radius-e.radius);e.rb.active=!1,cc.tween(e.node).to(.3,{position:t},{easing:"quadIn"}).call(()=>{e.node.setParent(this.mask),e.remove()}).by(.5,{position:cc.v2(0,2*-this.radius)},null).start()}getRadius(){return(this.radius+this.border)*this.lscale}setHoleSize(e){this.node.setScale(this.lscale=e/this.radius)}};return o([n],e.prototype,"radius",void 0),o([n],e.prototype,"border",void 0),o([n(cc.Node)],e.prototype,"mask",void 0),o([i],e)})();s.default=c,cc._RF.pop()},{}],KeyInputAxis:[function(e,t,s){"use strict";cc._RF.push(t,"f20baWULStPIKoISIzoSZUT","KeyInputAxis");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Arena"),n=e("./Game"),c=e("./KeyboardInput"),{ccclass:r,property:a}=cc._decorator;cc.Enum({NONE:0,ARROWS:1,WASD:2});let l=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.arena=null,this.moveAxis=0,this.rotAxis=0}onLoad(){this.arena||(this.arena=this.getComponent(i.default)),this.arena.node.on("resumed",this.onResume,this),this.arena.node.on("started",this.checkControls,this),this.checkControls()}update(e){c.default.isSomeKeyPressed()&&(this.moveAxis=c.default.getAxes([cc.macro.KEY.up,cc.macro.KEY.w],[cc.macro.KEY.down,cc.macro.KEY.s]),this.rotAxis=c.default.getAxes([cc.macro.KEY.left,cc.macro.KEY.a],[cc.macro.KEY.right,cc.macro.KEY.d]),this.moveAxis&&this.arena.level.moveByHandler(this.moveAxis),this.rotAxis&&this.arena.level.tiltByHandler(this.rotAxis))}onResume(){this.checkControls()}checkControls(){this.enabled=n.default.instance.settings.controls[ControlType.Keyboard]}};return o([a(cc.Node)],e.prototype,"arena",void 0),o([r],e)})();s.default=l,cc._RF.pop()},{"./Arena":"Arena","./Game":"Game","./KeyboardInput":"KeyboardInput"}],KeyboardInput:[function(e,t,s){"use strict";cc._RF.push(t,"45c9cqgTctO3bysXizFdmi4","KeyboardInput");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{var e;let t=e=class extends cc.Component{constructor(){return super(),this.downKeys=new Set,this.upKeys=new Set,this.pressedKeys=new Set,e._instance||(e._instance=this)}static get instance(){return e._instance}onLoad(){cc.systemEvent.on("keydown",this.onKeyDown,this),cc.systemEvent.on("keyup",this.onKeyUp,this)}lateUpdate(){if(this.downKeys.size){for(let e of this.downKeys)this.pressedKeys.add(e);this.downKeys.clear()}if(this.upKeys.size){for(let e of this.upKeys)this.pressedKeys.delete(e);this.upKeys.clear()}}static getAxis(t,s){let o=0;return e.instance.pressedKeys.has(t)&&o++,e.instance.pressedKeys.has(s)&&o--,o}static getAxes(t,s){let o=0;return t.some(t=>e.instance.pressedKeys.has(t))&&o++,s.some(t=>e.instance.pressedKeys.has(t))&&o--,o}static isSomeKeyPressed(){return e._instance.pressedKeys.size>0}static getKey(t){return e._instance.pressedKeys.has(t)}static getKeyDown(t){return e._instance.downKeys.has(t)}static getKeyUp(t){return e._instance.upKeys.has(t)}onKeyDown(e){this.downKeys.add(e.keyCode)}onKeyUp(e){this.upKeys.add(e.keyCode)}onDestroy(){cc.systemEvent.off("keydown",this.onKeyDown,this),cc.systemEvent.off("keyup",this.onKeyUp,this)}};return t._instance=null,e=o([i],t)})();s.default=c,cc._RF.pop()},{}],LevelBtn:[function(e,t,s){"use strict";cc._RF.push(t,"ba642ur1+xBC6Bie9ShFvIw","LevelBtn");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Game"),n=e("../LevelsArena"),{ccclass:c,property:r,requireComponent:a}=cc._decorator;let l=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.levelId="1",this.timeLabel=null,this.shadowNode=null,this.opened=!1,this.btn=null,this.levelData=null}onLoad(){this.btn=this.getComponent(cc.Button)}onEnable(){this.readSaveData(),(this.opened||this.levelData)&&this.onOpened(),cc.log("level btn enabled")}open(){}onOpened(){this.shadowNode.opacity=128,this.btn.interactable=!0,this.levelData&&this.levelData.bestScore>0&&(this.timeLabel.string=n.default.MilisecondsToMinSec(this.levelData.bestScore),this.timeLabel.node.active=!0)}readSaveData(){this.levelData=i.default.instance.progressData.LevelsArena[this.levelId]}};return o([r(cc.String)],e.prototype,"levelId",void 0),o([r(cc.Label)],e.prototype,"timeLabel",void 0),o([r(cc.Node)],e.prototype,"shadowNode",void 0),o([r],e.prototype,"opened",void 0),o([c,a(cc.Button)],e)})();s.default=l,cc._RF.pop()},{"../Game":"Game","../LevelsArena":"LevelsArena"}],LevelsArena:[function(e,t,s){"use strict";cc._RF.push(t,"09c0aOLf2BCDbLoUuzHfT+V","LevelsArena");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Arena"),n=e("./UI/NavigationPanel"),c=e("./TimeLevel"),{ccclass:r,property:a,executionOrder:l,disallowMultiple:h}=cc._decorator;let d=(()=>{var e;let t=e=class extends i.default{constructor(){super(...arguments),this.uiNode=null,this.scorePanel=null,this.summaryPanel=null,this.failurePanel=null,this.nextBtn=null,this.scoreLabel=null,this.bestScoreLabel=null,this.keyName="LevelsArena"}static MilisecondsToMinSec(t){this.time.setTime(t);let s=e.time.getMinutes().toString(),o=e.time.getSeconds().toString();return s.padStart(2,"0")+":"+o.padStart(2,"0")}onLoad(){super.onLoad()}lateUpdate(){this.level&&this.level.isRun&&this.setScoreLabel(this.level.score)}startGame(){super.startGame(),this.resetUI()}readyGame(){super.readyGame(),this.readyUI()}failGame(){super.failGame(),this.showFailureUI()}finishGame(){super.finishGame();let e=this.level.getComponent(c.default);e&&e.nextLevel&&(this.sd[e.nextLevel]={score:0,bestScore:0}),this.showSummaryUI()}endGame(){this.closeUI(),super.endGame()}onPause(){super.onPause(),this.hideUI()}onResume(){super.onResume(),this.showUI()}nextLevel(){let e=this.level.getComponent(c.default);e&&e.nextLevel&&this.loadLevel(e.nextLevel)}resetUI(){this.showUI(),this.scorePanel.hide(),this.summaryPanel.close(),this.failurePanel.close(),this.setScoreLabel(this.level.score)}readyUI(){this.scorePanel.show()}showSummaryUI(){this.checkNextBtn(),this.summaryPanel.openNext(),this.setScoreLabel(this.level.sd.score),this.setBestScoreLabel(this.level.sd.bestScore)}showFailureUI(){this.nextBtn.active=!1,this.scorePanel.hide(),this.failurePanel.openNext()}checkNextBtn(){let e=this.level.getComponent(c.default);e&&e.nextLevel?this.nextBtn.active=!0:this.nextBtn.active=!1}closeUI(){this.scorePanel.hide(),this.summaryPanel.close()}setScoreLabel(t){this.scoreLabel.string=e.MilisecondsToMinSec(t)}setBestScoreLabel(t){this.bestScoreLabel.string=e.MilisecondsToMinSec(t)}hideUI(){this.uiNode.active=!1}showUI(){this.uiNode.active=!0}};return t.time=new Date,o([a(cc.Node)],t.prototype,"uiNode",void 0),o([a(n.default)],t.prototype,"scorePanel",void 0),o([a(n.default)],t.prototype,"summaryPanel",void 0),o([a(n.default)],t.prototype,"failurePanel",void 0),o([a(cc.Node)],t.prototype,"nextBtn",void 0),o([a(cc.Label)],t.prototype,"scoreLabel",void 0),o([a(cc.Label)],t.prototype,"bestScoreLabel",void 0),e=o([r,l(-10),h],t)})();s.default=d,cc._RF.pop()},{"./Arena":"Arena","./TimeLevel":"TimeLevel","./UI/NavigationPanel":"NavigationPanel"}],Level:[function(e,t,s){"use strict";cc._RF.push(t,"4f98e72lytBq4qATiZlksSr","Level");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./BallSpawner"),n=e("./Ball"),c=e("./Block"),r=e("./Accelerator"),a=e("./HoleField"),l=e("./BackgroundGrad"),h=e("./SoundManager"),d=e("./Gameplay"),{ccclass:p,property:u}=cc._decorator;let f=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.speed=0,this.moveDir=-1,this.moveEasing="",this.startY=0,this.holeFields=[],this.moveWatchers=[],this.ballSpawner=null,this.platform=null,this.readyAudio=null,this.finishAudio=null,this.ballCatchAudio=null,this.watchersStartY=[],this.arena=null,this.ball=null,this.moveAcc=null,this.score=0,this.isReady=!1,this.isRun=!1,this.canMove=!0,this.sd={score:0,bestScore:0},this.dy=0,this.da=0,this.dt=0,this.dyt=0}onLoad(){this.platform.level=this,this.watchersStartY=this.moveWatchers.map(e=>e.y),this.moveAcc=this.node.addComponent(r.default),this.moveAcc.isFlipping=!0,this.moveAcc.dumpingSpeed=2,this.moveAcc.setEasing(this.moveEasing)}onEnable(){this.readSaveData()}reset(){this.node.opacity=255,this.isReady=this.isRun=!1,this.score=0;for(let e in this.holeFields)this.holeFields[e].reset(),this.holeFields[e].node.y=this.startY+this.node.height*parseInt(e);for(let e in this.watchersStartY)this.moveWatchers[e].y=this.watchersStartY[e];this.ballSpawner.spawn(e=>{this.ballSpawned(e.getComponent(n.default))}),this.platform.spawn(),this.ball&&this.ball.node&&(this.ball.node.destroy(),this.ball=null)}ready(){this.isReady=!0;for(let e of this.holeFields)e.setSpawn();h.default.playEffect(this.readyAudio)}run(){this.isRun=!0}fail(){this.onFinished()}finish(){this.writeScores(),this.onFinished()}onFinished(){this.isReady=this.isRun=!1,this.platform.remove(),cc.tween(this.node).call(()=>{h.default.playEffect(this.finishAudio)}).to(.5,{opacity:0},null).start();for(let e of this.holeFields)e.setClear();this.ball&&this.ball.node&&(this.ball.node.destroy(),this.ball=null)}end(){this.writeSaveData()}update(e){this.dt=e,!d.default.paused&&this.isReady&&this.isRun&&(this.dyt=this.moveAcc.y*(0!==this.dy?Math.abs(this.dy):1)*this.dt,0!==this.dyt&&(this.moveFieldBy(this.dyt),this.moveWatchersBy(this.dyt),this.platform.moveBy(this.dyt)))}onDestroy(){this.writeSaveData()}moveByHandler(e){!d.default.paused&&this.canMove&&this.isReady&&(this.isRun||this.run(),this.moveBy(e))}tiltByHandler(e){!d.default.paused&&this.isReady&&this.tiltBy(e)}tiltToHandler(e){!d.default.paused&&this.isReady&&this.tiltTo(e)}moveBy(e){this.dy=e,this.moveAcc.by(this.dy*this.dt)}tiltBy(e){this.da=e,0!==e&&(e*=this.dt,this.platform.tiltBy(e))}tiltTo(e){this.platform.tiltTo(e)}moveWatchersBy(e){for(let t of this.moveWatchers)t.y+=e*this.speed*this.moveDir;l.default._instance.moveY(e*this.speed/3*this.moveDir)}moveFieldBy(e){for(let t of this.holeFields)t.node.y+=e*this.speed*this.moveDir}ballReady(e=!0){e?this.arena.readyGame():this.isReady=!1}ballSpawned(e){this.ball&&this.ball.node.destroy(),this.ball=e,this.ball.level=this}ballCaptured(e){this.isReady=!1,h.default.playEffect(this.ballCatchAudio)}ballRemoved(e){this.ball=null,this.arena.failGame()}writeScores(){this.sd.score=this.score,this.score>this.sd.bestScore&&(this.sd.bestScore=this.score)}readSaveData(){this.sd=this.arena.sd[this.node.name]||this.sd,cc.log(this.node.name+" save data "+JSON.stringify(this.sd))}writeSaveData(){this.arena.sd[this.node.name]=this.sd}};return o([u],e.prototype,"speed",void 0),o([u({type:cc.Integer,min:-1,max:1})],e.prototype,"moveDir",void 0),o([u(cc.String)],e.prototype,"moveEasing",void 0),o([u],e.prototype,"startY",void 0),o([u(a.default)],e.prototype,"holeFields",void 0),o([u(cc.Node)],e.prototype,"moveWatchers",void 0),o([u(i.default)],e.prototype,"ballSpawner",void 0),o([u(c.default)],e.prototype,"platform",void 0),o([u({type:cc.AudioClip})],e.prototype,"readyAudio",void 0),o([u({type:cc.AudioClip})],e.prototype,"finishAudio",void 0),o([u({type:cc.AudioClip})],e.prototype,"ballCatchAudio",void 0),o([p],e)})();s.default=f,cc._RF.pop()},{"./Accelerator":"Accelerator","./BackgroundGrad":"BackgroundGrad","./Ball":"Ball","./BallSpawner":"BallSpawner","./Block":"Block","./Gameplay":"Gameplay","./HoleField":"HoleField","./SoundManager":"SoundManager"}],LiftUp:[function(e,t,s){"use strict";cc._RF.push(t,"16f25v0nHFCuJpjhhZGOTKf","LiftUp");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./SoundManager"),n=e("./Arena"),{ccclass:c,property:r}=cc._decorator;let a=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.destroyParticle=null,this.pickSound=null}onCollisionEnter(e,t){if("ball"===e.node.group){if(this.destroyParticle){let e=cc.instantiate(this.destroyParticle);e.setParent(this.node.parent),e.setPosition(this.node.position)}i.default.playEffect(this.pickSound),this.onPicked(),this.node.destroy()}}onPicked(){n.default.instance.level.node.emit("powerup","liftUp")}};return o([r(cc.Prefab)],e.prototype,"destroyParticle",void 0),o([r({type:cc.AudioClip})],e.prototype,"pickSound",void 0),o([c],e)})();s.default=a,cc._RF.pop()},{"./Arena":"Arena","./SoundManager":"SoundManager"}],MainUI:[function(e,t,s){"use strict";cc._RF.push(t,"0fb30UgmbNMu5kQa+cf/HHH","MainUI");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Game"),{ccclass:n,property:c}=cc._decorator;let r=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.recordsPanel=null,this.scoreLabel=null,this.bestScoreLabel=null,this.gemsLabel=null}onEnable(){this.setGemsLabel(),this.showRecordsPanel()}setGemsLabel(){this.gemsLabel.string=i.default.instance.progressData.EndlessArena.gems+""}showRecordsPanel(){let e=i.default.instance.progressData.EndlessArena.EndlessLevel;this.recordsPanel&&e&&e.score&&e.bestScore&&(this.recordsPanel.active=!0,this.scoreLabel.string=e.score+"",this.bestScoreLabel.string=e.bestScore+"")}};return o([c(cc.Node)],e.prototype,"recordsPanel",void 0),o([c(cc.Label)],e.prototype,"scoreLabel",void 0),o([c(cc.RichText)],e.prototype,"bestScoreLabel",void 0),o([c(cc.Label)],e.prototype,"gemsLabel",void 0),o([n],e)})();s.default=r,cc._RF.pop()},{"../Game":"Game"}],MathModule:[function(e,t,s){"use strict";cc._RF.push(t,"561281MV15OmKbnQvtOyb8p","MathModule"),Object.defineProperty(s,"__esModule",{value:!0}),s.default=class{static clamp(e,t=0,s=1){return e<t?t:e>s?s:e}static lerp(e,t,s){return e+(t-e)*s}static moveTowards(e,t,s){let o=t-e,i=Math.abs(o);return i<=Number.EPSILON?t:(s>i&&(s=i),e+s*Math.sign(o))}},cc._RF.pop()},{}],MovingHole:[function(e,t,s){"use strict";cc._RF.push(t,"738c8oWsvtLdK6HAOPvhjLt","MovingHole");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Hole"),{ccclass:n,property:c}=cc._decorator;let r=(()=>{var e;let t=e=class extends i.default{constructor(){super(...arguments),this.speed=250,this.dir=1,this.moveFunc=null}onLoad(){super.onLoad(),this.moveFunc=this.horizontalMove,this.node.name="MovingHole"}update(e){this.isBallCaptured||this.moveFunc(e)}onCollisionEnter(t,s){1===s.tag&&"hole"===t.node.group&&("MovingHole"===t.node.name&&1===t.tag?t.getComponent(e).dir=-this.dir:0===t.tag&&(this.dir=-this.dir))}onCollisionStay(t,s){1===s.tag&&"hole"===t.node.group&&"MovingHole"===t.node.name&&1===t.tag&&(t.getComponent(e).dir=-this.dir)}horizontalMove(e){let t=this.node.parent.width/2;this.node.x>=t-2*this.getRadius()?this.dir=-1:this.node.x<=-t+2*this.getRadius()&&(this.dir=1),this.node.x+=e*this.dir*this.speed}};return e=o([n],t)})();s.default=r,cc._RF.pop()},{"../Hole":"Hole"}],NavigationBtn:[function(e,t,s){"use strict";cc._RF.push(t,"edf727gOcBLvIzbCbQ691ru","NavigationBtn");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n,requireComponent:c}=cc._decorator;let r=(()=>{var e;let t=e=class extends cc.Component{constructor(){super(...arguments),this.up=null,this.right=null,this.down=null,this.left=null,this.isFocused=!1,this.btn=null}onLoad(){this.btn=this.getComponent(cc.Button),this.isFocused&&!e.focusedBtn&&(e.focusedBtn=this,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,e.onKeyDown),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,e.onKeyUp),this.isFocused=!1)}hide(){this.node.active=!1}show(){this.node.active=!0}moveUp(){this.setFocus(this.up)}moveRight(){this.setFocus(this.right)}moveDown(){this.setFocus(this.down)}moveLeft(){this.setFocus(this.left)}setFocus(t){t&&(e.focusedBtn=t,t.onFocused(),this.onUnfocused())}clickDown(){this.btn.node.dispatchEvent(new cc.Event.EventCustom("touchstart",!0))}clickUp(){this.btn.node.dispatchEvent(new cc.Event.EventCustom("touchend",!0))}onFocused(){if(!this.isFocused){switch(this.btn.transition){case cc.Button.Transition.COLOR:this.btn.target.color=this.btn.hoverColor;break;case cc.Button.Transition.SCALE:this.btn.node.scale*=(Math.floor(this.btn.zoomScale)+this.btn.zoomScale)/2;break;case cc.Button.Transition.SPRITE:this.btn.target.getComponent(cc.Sprite).spriteFrame=this.btn.hoverSprite}this.isFocused=!0}}onUnfocused(){if(this.isFocused){switch(this.btn.transition){case cc.Button.Transition.COLOR:this.btn.target.color=this.btn.normalColor;break;case cc.Button.Transition.SCALE:this.btn.node.scale/=(Math.floor(this.btn.zoomScale)+this.btn.zoomScale)/2;break;case cc.Button.Transition.SPRITE:this.btn.target.getComponent(cc.Sprite).spriteFrame=this.btn.normalSprite}this.isFocused=!1}}static onKeyDown(t){switch(t.keyCode){case cc.macro.KEY.enter:e.focusedBtn.clickDown();break;case cc.macro.KEY.up:e.focusedBtn.moveUp();break;case cc.macro.KEY.right:e.focusedBtn.moveRight();break;case cc.macro.KEY.down:e.focusedBtn.moveDown();break;case cc.macro.KEY.left:e.focusedBtn.moveLeft()}}static onKeyUp(t){switch(t.keyCode){case cc.macro.KEY.enter:e.focusedBtn.clickUp()}}};return t.focusedBtn=null,o([n(e)],t.prototype,"up",void 0),o([n(e)],t.prototype,"right",void 0),o([n(e)],t.prototype,"down",void 0),o([n(e)],t.prototype,"left",void 0),o([n],t.prototype,"isFocused",void 0),e=o([i,c(cc.Button)],t)})();s.default=r,cc._RF.pop()},{}],NavigationPanel:[function(e,t,s){"use strict";cc._RF.push(t,"0edc8YeHuZGnLtpePE+osGE","NavigationPanel");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{var e;let t=e=class extends cc.Component{constructor(){super(...arguments),this.isOpen=!1,this.onEscape=[],this.openedEvent=[],this.closedEvent=[],this.isShow=!1,this.prevPanel=null,this.nextPanel=null}onLoad(){this.isOpen&&!e.focusedPanel&&(e.focusedPanel=this,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,e.onKeyUp),this.isShow=!0,this.onOpen())}hide(){this.isShow&&(this.node.active=!1,this.isShow=!1)}show(){this.isShow||(this.node.active=!0,this.isShow=!0)}openNext(){e.focusedPanel&&e.focusedPanel.hide(),this.open()}openPrevious(){let e=this.prevPanel;this.closeNext(this),e&&(e.nextPanel=null,e.open())}close(){this.prevPanel&&(e.focusedPanel=this.prevPanel),this.closeNext(this)}open(){this.isOpen?this.isShow||(e.focusedPanel=this,this.show()):(this.isOpen=!0,e.focusedPanel&&(this.prevPanel=e.focusedPanel,this.prevPanel.nextPanel=this),e.focusedPanel=this,this.show(),this.onOpen()),cc.log("opened panel "+this.node.name+"\nprev "+(this.prevPanel?this.prevPanel.node.name:null))}closeNext(e){cc.log("closed panel "+this.node.name+"\nprev "+(this.prevPanel?this.prevPanel.node.name:null)+"\nnext "+(this.nextPanel?this.nextPanel.node.name:null)),e||(e=this),e.nextPanel&&e.nextPanel.closeNext(),e.isOpen?(this.isOpen=!1,e.nextPanel=e.prevPanel=null,this.hide(),this.onClose()):e.isShow&&e.hide()}onOpen(){this.openedEvent.forEach(e=>e.emit(null))}onClose(){this.closedEvent.forEach(e=>e.emit(null))}static onKeyUp(t){switch(t.keyCode){case cc.macro.KEY.back:case cc.macro.KEY.backspace:case cc.macro.KEY.escape:e.focusedPanel.isOpen&&(e.focusedPanel.onEscape.length?e.focusedPanel.onEscape.forEach(e=>e.emit(null)):e.focusedPanel.openPrevious())}}};return t.focusedPanel=null,o([n],t.prototype,"isOpen",void 0),o([n(cc.Component.EventHandler)],t.prototype,"onEscape",void 0),o([n(cc.Component.EventHandler)],t.prototype,"openedEvent",void 0),o([n(cc.Component.EventHandler)],t.prototype,"closedEvent",void 0),e=o([i],t)})();s.default=c,cc._RF.pop()},{}],NodeEventsHandlers:[function(require,module,exports){"use strict";cc._RF.push(module,"a2833NffThP1YP0E5y5Wa7h","NodeEventsHandlers");var __decorate=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(exports,"__esModule",{value:!0});const{ccclass:ccclass,property:property}=cc._decorator;let NodeEventHandlers=(()=>{let NodeEventHandlers=class NodeEventHandlers extends cc.Component{activate(){this.node.active=!0}deactivate(){this.node.active=!1}evalCode(event,code){code&&eval(code)}};return NodeEventHandlers=__decorate([ccclass],NodeEventHandlers),NodeEventHandlers})();exports.default=NodeEventHandlers,cc._RF.pop()},{}],RadioBtn:[function(e,t,s){"use strict";cc._RF.push(t,"25c93cZywVDmqzV1lWLuaEn","RadioBtn");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n,requireComponent:c}=cc._decorator;let r=(()=>{var e;let t=e=class extends cc.Component{constructor(){super(...arguments),this.group=0,this.isOn=!0,this.onEvents=[],this.offEvents=[],this.btn=null}onLoad(){this.btn=this.getComponent(cc.Button),this.registerEvents(),this.addToGroup()}start(){this.isOn&&this.checkOn()}onDestroy(){this.unregisterEvents()}addToGroup(){e.groups[this.group]||(e.groups[this.group]=new Set),e.groups[this.group].add(this),cc.log("added to group "+this.group)}registerEvents(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)}unregisterEvents(){this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)}hide(){this.node.active=!1}show(){this.node.active=!0}check(){this.isOn||this.checkOn()}checkOn(){e.groups[this.group].forEach(e=>{e!=this&&e.isOn&&e.checkOff()}),this.isOn=!0,this.btn.interactable=!1,this.onEvents.forEach(e=>e.emit([e.customEventData])),cc.log("radio on "+this.node.name)}checkOff(){this.isOn=!1,this.btn.interactable=!0,this.offEvents.forEach(e=>e.emit([e.customEventData])),cc.log("radio off "+this.node.name)}onTouchEnd(e){this.check()}};return t.groups=[],o([n({type:cc.Integer,min:0})],t.prototype,"group",void 0),o([n],t.prototype,"isOn",void 0),o([n(cc.Component.EventHandler)],t.prototype,"onEvents",void 0),o([n(cc.Component.EventHandler)],t.prototype,"offEvents",void 0),e=o([i,c(cc.Button)],t)})();s.default=r,cc._RF.pop()},{}],RandomHoleField:[function(e,t,s){"use strict";cc._RF.push(t,"d5761NL421F/Y4M5RcY4fK6","RandomHoleField");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./HoleField"),n=e("./Hole"),{ccclass:c,property:r}=cc._decorator;let a=(()=>{let e=class extends i.default{constructor(){super(...arguments),this.holePrefabs=[],this.holesDensity=[],this.gemPrefab=null,this.powerupPrefabs=[],this.bonuseRect=null,this.maxGemsNum=1,this.maxPowerupNum=1,this.cellSize=100,this.maxFillPercentage=.5,this.holeRadiuses=[],this.holeVariantsPool=[],this.timeout=2500,this.holesPool=[],this.activeHoles=[],this.holeSampleIndex=null,this.freeCellIndex=null,this.holeVariant=0,this.powerupVariant=-1,this.holesLimit=20,this.numOfHoles=0,this.gemsCount=0,this.powerupsCount=0,this.cellsMap=new Map,this.gridPoints=new Map,this.freeCells=[],this.rows=0,this.columns=0,this.nodeSample=null,this.rect=null,this.startTime=0,this.done=!0,this.clearDone=!0,this.anim=!1,this.startFillRate=0}onLoad(){this.rect=this.rectNode.getBoundingBox(),this.startFillRate=this.maxFillPercentage,this.rows=Math.ceil(this.rect.height/this.cellSize),this.columns=Math.ceil(this.rect.width/this.cellSize),console.log("---------grid initialized rows "+this.rows+" cols "+this.columns);let e=(this.rect.width-this.columns*this.cellSize)/(this.columns+1),t=(this.rect.height-this.rows*this.cellSize)/(this.rows+1);for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.gridPoints.set([s,o],{x:this.rect.x+e*(o+1)+this.cellSize*o+this.cellSize/2,y:this.rect.y+t*(s+1)+this.cellSize*s+this.cellSize/2})}reset(){this.clear(),this.maxFillPercentage=this.startFillRate,this.holesLimit=this.rows*this.columns*this.maxFillPercentage,this.activeHoles=[],this.holesPool=[],this.powerupVariant=-1,this.fillHolesPool(this.holeVariant=0)}clear(){for(let e of this.activeHoles)e.removeFromParent(!1);this.onCleared()}onCleared(){this.clearBonuses(),this.numOfHoles=0,this.freeCells=[...this.gridPoints.keys()],this.activeHoles.length&&this.holesPool.push(...this.activeHoles.splice(0)),this.cellsMap.clear(),this.clearDone=!0}setClear(){this.isInParentRect()?(this.clearDone=!1,this.startTime=Date.now()):this.clear()}spawn(){this.spawnGems(),this.spawnPowerUp();let e=2*this.freeCells.length;for(;e>0&&this.numOfHoles<=this.holesLimit&&this.freeCells.length>0;){let t=this.getHoleSample();t&&this.checkExtent(t)&&!this.intersectNear(t)&&this.spawnSample(t),--e}this.onSpawned()}setSpawn(){this.done=!1,this.spawnGems(),this.spawnPowerUp(),this.startTime=Date.now(),this.isInParentRect()?this.anim=!0:this.anim=!1}onSpawned(){this.done=!0}isInParentRect(){return this.node.y<=this.node.parent.height/2+this.node.height/2&&this.node.y>=-this.node.parent.height/2-this.node.height/2}holeCleaner(){if(!this.clearDone&&this.done)if(this.activeHoles.length>0){let e=Math.floor(Math.random()*this.activeHoles.length),t=this.activeHoles.splice(e,1)[0];t.emit("remove",()=>{t.removeFromParent(!1)}),this.holesPool.push(t);let s=Date.now()-this.startTime;(this.clearDone=s>this.timeout)&&this.clear()}else this.onCleared()}holeEmitter(){if(!this.done&&this.clearDone)if(this.numOfHoles<=this.holesLimit&&this.freeCells.length>0){let e=this.getHoleSample();e&&this.checkExtent(e)&&!this.intersectNear(e)&&(this.spawnSample(e),this.anim&&e.emit("spawn"));let t=Date.now()-this.startTime;(this.done=t>this.timeout)&&this.spawn()}else this.onSpawned()}spawnSample(e){e.setParent(this.rectNode);let t=this.freeCells.splice(this.freeCellIndex,1)[0];this.cellsMap.set(t[0]+""+t[1],e),this.holesPool.splice(this.holeSampleIndex,1),this.activeHoles.push(e),this.numOfHoles++}spawnPrefabIn(e,t){let s=cc.instantiate(e);this.freeCellIndex=Math.floor(Math.random()*this.freeCells.length);let o=cc.v2(this.gridPoints.get(this.freeCells[this.freeCellIndex])),i=this.freeCells.splice(this.freeCellIndex,1)[0];this.cellsMap.set(i[0]+""+i[1],s),s.setParent(t),s.setPosition(o)}spawnGems(){if(0===this.gemsCount&&this.gemPrefab&&this.freeCells)for(let e=0;e<this.maxGemsNum&&this.gemsCount<=this.maxGemsNum;++e)Math.random()<.5&&(this.spawnPrefabIn(this.gemPrefab,this.bonuseRect),++this.gemsCount,++this.numOfHoles)}spawnPowerUp(){if(0===this.powerupsCount&&this.powerupVariant>-1&&this.powerupPrefabs&&this.freeCells)for(let e=0;e<this.maxPowerupNum&&this.powerupsCount<=this.maxPowerupNum;++e)if(Math.random()<.3){let e=this.powerupPrefabs[Math.floor(Math.random()*this.powerupVariant)];this.spawnPrefabIn(e,this.bonuseRect),++this.powerupsCount,++this.numOfHoles}}clearBonuses(){this.bonuseRect.destroyAllChildren(),this.gemsCount=0,this.powerupsCount=0}intersectNear(e){let[t,s]=this.freeCells[this.freeCellIndex],o=Math.max(t-1,0),i=Math.min(t+1,this.rows),c=Math.max(s-1,0),r=Math.min(s+1,this.columns);for(let a=o;a<=i;a++)for(let t=c;t<=r;t++){let s=this.cellsMap.get(a+""+t);if(s&&"hole"===s.group){let t={position:e.position,radius:e.getComponent(n.default).getRadius()},o={position:s.position,radius:s.getComponent(n.default).getRadius()};if(cc.Intersection.circleCircle(t,o))return!0}}return!1}checkExtent(e){let t=e.getBoundingBox();return this.rect.containsRect(t)}getHoleSample(){if(this.holesPool.length>0){this.holeSampleIndex=Math.floor(Math.random()*this.holesPool.length);let e=this.holesPool[this.holeSampleIndex];this.freeCellIndex=Math.floor(Math.random()*this.freeCells.length);let t=Math.random();this.setHoleRandSize(e.getComponent(n.default));let s=cc.v2(this.gridPoints.get(this.freeCells[this.freeCellIndex])),o=cc.Vec2.RIGHT.mul(t*(this.cellSize/2)).rotate(2*t*Math.PI);return e.position=s.addSelf(o),e}return null}fillHolesPool(e){if(e<this.holePrefabs.length&&this.holesPool.length<this.rows*this.columns*2){if(!this.holeVariantsPool[e]){let t=this.holePrefabs[e],s=this.rows*this.columns*(this.holesDensity[e]||0);this.holeVariantsPool[e]=[];for(let o=0;o<s;o++)this.holeVariantsPool[e].push(cc.instantiate(t))}this.holesPool.push(...this.holeVariantsPool[e])}}setHoleRandSize(e){let t=this.holeRadiuses[Math.floor(Math.random()*this.holeRadiuses.length)];e.setHoleSize(t)}levelUp(){Math.random()<.6?this.fillRateUp():this.revealNextHole()}fillRateUp(e=.05){this.maxFillPercentage=cc.misc.clamp01(this.maxFillPercentage+e),this.holesLimit=this.rows*this.columns*this.maxFillPercentage,cc.log(this.node.name+" fill rate up")}revealNextHole(){this.holeVariant<this.holePrefabs.length&&(cc.log(this.node.name+" revealed new node"),this.fillHolesPool(++this.holeVariant))}revealNextPowerUp(){this.powerupVariant<this.powerupPrefabs.length&&(cc.log(this.node.name+" revealed new poweup"),++this.powerupVariant)}};return o([r(cc.Prefab)],e.prototype,"holePrefabs",void 0),o([r({type:cc.Float,min:0,max:1})],e.prototype,"holesDensity",void 0),o([r(cc.Prefab)],e.prototype,"gemPrefab",void 0),o([r(cc.Prefab)],e.prototype,"powerupPrefabs",void 0),o([r(cc.Node)],e.prototype,"bonuseRect",void 0),o([r],e.prototype,"maxGemsNum",void 0),o([r],e.prototype,"maxPowerupNum",void 0),o([r],e.prototype,"cellSize",void 0),o([r({min:0,max:1})],e.prototype,"maxFillPercentage",void 0),o([r([cc.Float])],e.prototype,"holeRadiuses",void 0),o([c],e)})();s.default=a,cc._RF.pop()},{"./Hole":"Hole","./HoleField":"HoleField"}],RecordLine:[function(e,t,s){"use strict";cc._RF.push(t,"29d493g2XNESqT580fvBWBn","RecordLine");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n,requireComponent:c}=cc._decorator;let r=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.breakParticle=null}onCollisionEnter(e,t){if("ball"===e.node.group){let e=cc.instantiate(this.breakParticle);this.node.active=!1,e.setParent(this.node.parent),e.setPosition(this.node.position)}}};return o([n(cc.Prefab)],e.prototype,"breakParticle",void 0),o([i],e)})();s.default=r,cc._RF.pop()},{}],SettingUI:[function(e,t,s){"use strict";cc._RF.push(t,"29606mhycNLo78iZ3KYIglA","SettingUI");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Game"),n=e("./RadioBtn"),c=e("./SpriteToggleBtn"),{ccclass:r,property:a}=cc._decorator;let l=(()=>{var e;let t=e=class extends cc.Component{constructor(){return super(),this.soundBtn=null,this.musicBtn=null,this.keyContrBtn=null,this.touchContrBtn=null,this.tiltContrBtn=null,console.log("setting constructor"),e._instance||(e._instance=this)}static get instance(){return e._instance}onLoad(){i.default.instance.settings.music?this.musicBtn.toggleOn():this.musicBtn.toggleOff(),i.default.instance.settings.sound?this.soundBtn.toggleOn():this.soundBtn.toggleOff(),this.keyContrBtn.node.active=!cc.sys.isMobile,this.touchContrBtn.node.active=cc.sys.isMobile||cc.sys.isNative||cc.sys.isBrowser,this.tiltContrBtn.node.active=cc.sys.isMobile}init(){cc.sys.isMobile?this.setTouchControls():this.setKeyboardControls()}star(){i.default.instance.settings.controls[ControlType.Keyboard]?this.keyContrBtn.checkOn():i.default.instance.settings.controls[ControlType.Touch]?this.touchContrBtn.checkOn():i.default.instance.settings.controls[ControlType.Tilt]?this.tiltContrBtn.checkOn():cc.sys.isMobile?this.touchContrBtn.checkOn():(this.keyContrBtn.node.active=!0,this.keyContrBtn.checkOn())}toggleMusic(){i.default.instance.settings.music?this.musicOff():this.musicOn()}toggleSound(){i.default.instance.settings.sound?this.soundOff():this.soundOn()}soundOn(){cc.audioEngine.setEffectsVolume(1),i.default.instance.settings.sound=!0,cc.log("sound on"),this.musicOn()}soundOff(){cc.audioEngine.setEffectsVolume(0),i.default.instance.settings.sound=!1,cc.log("sound off"),this.musicOff()}musicOn(){cc.audioEngine.setMusicVolume(1),i.default.instance.settings.music=!0,cc.log("music on")}musicOff(){cc.audioEngine.setMusicVolume(0),i.default.instance.settings.music=!1,cc.log("music off")}setKeyboardControlsHandler(e,t){cc.log("%%%%%% key sender "+typeof e),cc.log("%%%%%% key data "+t),this.setKeyboardControls("false"!=t)}setTouchControlsHandler(e,t){cc.log("%%%%%% touch sender "+typeof e),cc.log("%%%%%% touch data "+t),this.setTouchControls("false"!=t)}setTiltControlsHandler(e,t){cc.log("%%%%%% tilt sender "+typeof e),cc.log("%%%%%% data "+t),this.setTiltControls("false"!=t)}setKeyboardControls(e=!0){e?this.addControls(ControlType.Keyboard):this.removeControls(ControlType.Keyboard)}setTouchControls(e=!0){e?this.addControls(ControlType.Touch):this.removeControls(ControlType.Touch)}setTiltControls(e=!0){e?this.addControls(ControlType.Tilt):this.removeControls(ControlType.Tilt)}addControls(e){i.default.instance.settings.controls[e]||(i.default.instance.settings.controls[e]=!0)}removeControls(e){i.default.instance.settings.controls[e]&&(i.default.instance.settings.controls[e]=!1)}};return t._instance=null,o([a(c.default)],t.prototype,"soundBtn",void 0),o([a(c.default)],t.prototype,"musicBtn",void 0),o([a(n.default)],t.prototype,"keyContrBtn",void 0),o([a(n.default)],t.prototype,"touchContrBtn",void 0),o([a(n.default)],t.prototype,"tiltContrBtn",void 0),e=o([r],t)})();s.default=l,cc._RF.pop()},{"../Game":"Game","./RadioBtn":"RadioBtn","./SpriteToggleBtn":"SpriteToggleBtn"}],SoundManager:[function(e,t,s){"use strict";cc._RF.push(t,"534bdAIA3RCFIX8lmUCo9hu","SoundManager");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n,executionOrder:c,disallowMultiple:r}=cc._decorator;let a=(()=>{var e;let t=e=class extends cc.Component{constructor(){return super(),this.backgroundMusic=null,e._instance||(e._instance=this)}static get instance(){return e._instance}start(){cc.audioEngine.playMusic(this.backgroundMusic,!0)}static playEffect(e,t=!1){e?cc.audioEngine.playEffect(e,t):cc.log("audio clip is null")}};return t._instance=null,o([n({type:cc.AudioClip})],t.prototype,"backgroundMusic",void 0),e=o([i,c(-13),r],t)})();s.default=a,cc._RF.pop()},{}],SpriteToggleBtn:[function(e,t,s){"use strict";cc._RF.push(t,"013b9yycERB4p09e2UVb8f0","SpriteToggleBtn");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./ToggleBtn"),{ccclass:n,property:c}=cc._decorator;let r=(()=>{let e=class extends i.default{constructor(){super(...arguments),this.target=null,this.onSprite=null,this.offSprite=null}toggleOn(){this.isOn||(this.target.spriteFrame=this.onSprite,super.toggleOn())}toggleOff(){this.isOn&&(this.target.spriteFrame=this.offSprite,super.toggleOff())}onTouchEnd(e){this.toggle()}};return o([c(cc.Sprite)],e.prototype,"target",void 0),o([c(cc.SpriteFrame)],e.prototype,"onSprite",void 0),o([c(cc.SpriteFrame)],e.prototype,"offSprite",void 0),o([n],e)})();s.default=r,cc._RF.pop()},{"./ToggleBtn":"ToggleBtn"}],TN_BGAdapter:[function(e,t,s){"use strict";cc._RF.push(t,"d23dbr3lZxLqYDlAk5nEx9L","TN_BGAdapter");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.designWidth=720,this.designHeight=1280}onLoad(){let e=Math.min(cc.view.getCanvasSize().width/this.node.width,cc.view.getCanvasSize().height/this.node.height),t=this.node.width*e,s=this.node.height*e;this.node.scale=Math.max(cc.view.getCanvasSize().width/t,cc.view.getCanvasSize().height/s)}update(e){this.deviceWidth=cc.view.getFrameSize().width,this.deviceHeight=cc.view.getFrameSize().height,this.deviceHeight/this.deviceWidth<1.5?(this.node.parent.getComponent(cc.Canvas).fitHeight=!0,this.node.parent.getComponent(cc.Canvas).fitWidth=!0):(this.node.parent.getComponent(cc.Canvas).fitHeight=!1,this.node.parent.getComponent(cc.Canvas).fitWidth=!0)}};return e.positionY=0,o([i],e)})();s.default=c,cc._RF.pop()},{}],TargetHole:[function(e,t,s){"use strict";cc._RF.push(t,"fc513wpIxBIVYNELakhifjT","TargetHole");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Hole"),{ccclass:n,property:c}=cc._decorator;let r=(()=>{let e=class extends i.default{constructor(){super(...arguments),this.ballCatchParticle=null}captureBall(e){this.isBallCaptured=!0,e.node.setParent(this.node),0!=this.node.scale&&(e.node.scale=1/this.node.scale-.1),e.rb.active=!1,cc.tween(e.node).to(.3,{position:cc.v2(0,0)},{easing:"quadIn"}).call(()=>{if(e.node.setParent(this.mask),this.ballCatchParticle){let e=cc.instantiate(this.ballCatchParticle);this.node.addChild(e,0),e.setPosition(0,0)}}).delay(1).call(()=>{e.level.arena.finishGame()}).start()}};return o([c(cc.Prefab)],e.prototype,"ballCatchParticle",void 0),o([n],e)})();s.default=r,cc._RF.pop()},{"../Hole":"Hole"}],TiltInputAxis:[function(e,t,s){"use strict";cc._RF.push(t,"6c834eovPpHo7EJGcVxwiJG","TiltInputAxis");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Arena"),n=e("./Game"),{ccclass:c,property:r}=cc._decorator;let a=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.moveUnit=100,this.accUnit=1,this.touchArea=null,this.arena=null,this.startPoint=cc.Vec2.ZERO,this.movePoint=cc.Vec2.ZERO,this.accX=0,this.oAccX=0,this.isActive=!1}onLoad(){this.arena||(this.arena=this.getComponent(i.default)),this.arena.node.on("resumed",this.onResume,this),this.arena.node.on("started",this.checkControls,this),this.checkControls()}onEnable(){this.registerEvents()}onDisable(){this.unregisterEvents()}update(e){this.isActive&&this.arena.level.moveByHandler(this.movePoint.y/this.moveUnit),Math.abs(this.accX-this.oAccX)>.05&&this.arena.level.tiltToHandler(-this.accX/this.accUnit)}onResume(){this.checkControls()}checkControls(){this.enabled=n.default.instance.settings.controls[ControlType.Tilt]}registerEvents(){cc.systemEvent.setAccelerometerEnabled(!0),cc.systemEvent.setAccelerometerInterval(.02),this.touchArea.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touchArea.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touchArea.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.touchArea.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION,this.onTilt,this)}unregisterEvents(){cc.systemEvent.setAccelerometerEnabled(!1),this.touchArea.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touchArea.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touchArea.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.touchArea.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION,this.onTilt,this)}onTouchStart(e){e.getID()<1&&(this.startPoint=e.getLocation(),this.isActive=!0)}onTouchMove(e){e.getID()<1&&(this.movePoint=e.getLocation().subSelf(this.startPoint),this.movePoint.y=cc.misc.clampf(this.movePoint.y,-this.moveUnit,this.moveUnit))}onTouchEnd(e){e.getID()<1&&(this.startPoint=cc.Vec2.ZERO,this.movePoint.y=0,this.isActive=!1)}onTilt(e){e.acc&&(this.oAccX=this.accX,this.accX=e.acc.x,cc.log("acc vector x "+e.acc))}};return o([r({type:cc.Integer,min:1})],e.prototype,"moveUnit",void 0),o([r({type:cc.Float,min:.1,max:1,step:.1})],e.prototype,"accUnit",void 0),o([r(cc.Node)],e.prototype,"touchArea",void 0),o([r(cc.Node)],e.prototype,"arena",void 0),o([c],e)})();s.default=a,cc._RF.pop()},{"./Arena":"Arena","./Game":"Game"}],TimeLevel:[function(e,t,s){"use strict";cc._RF.push(t,"cdce9N8pdRM8K91QPEyLVAn","TimeLevel");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Level"),n=e("./Gameplay"),{ccclass:c,property:r}=cc._decorator;let a=(()=>{let e=class extends i.default{constructor(){super(...arguments),this.nextLevel="",this.arena=null}reset(){super.reset()}update(e){super.update(e),!n.default.paused&&this.isRun&&this.isReady&&(this.score+=1e3*e)}writeScores(){this.sd.score=this.score,(this.score<this.sd.bestScore||!this.sd.bestScore)&&(this.sd.bestScore=this.score)}};return o([r(cc.String)],e.prototype,"nextLevel",void 0),o([c],e)})();s.default=a,cc._RF.pop()},{"./Gameplay":"Gameplay","./Level":"Level"}],ToggleBtn:[function(e,t,s){"use strict";cc._RF.push(t,"d933bDxbkNO/6LNreUH2/Z3","ToggleBtn");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n}=cc._decorator;let c=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.isOn=!0,this.onEvents=[],this.offEvents=[],this.btn=null}onLoad(){this.btn=this.getComponent(cc.Button),this.registerEvents()}start(){this.isOn&&this.toggleOn()}onDestroy(){this.unregisterEvents()}registerEvents(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)}unregisterEvents(){this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)}hide(){this.node.active=!1}show(){this.node.active=!0}toggle(){this.isOn?this.toggleOff():this.toggleOn()}toggleOn(){this.isOn=!0,this.onEvents.forEach(e=>e.emit([e.customEventData]))}toggleOff(){this.isOn=!1,this.offEvents.forEach(e=>e.emit([e.customEventData]))}onTouchEnd(e){this.toggle()}};return o([n],e.prototype,"isOn",void 0),o([n(cc.Component.EventHandler)],e.prototype,"onEvents",void 0),o([n(cc.Component.EventHandler)],e.prototype,"offEvents",void 0),o([i],e)})();s.default=c,cc._RF.pop()},{}],TouchInputAxis:[function(e,t,s){"use strict";cc._RF.push(t,"e1e751ZIhhDz6MmpSZt+Zao","TouchInputAxis");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Arena"),n=e("./Game"),{ccclass:c,property:r}=cc._decorator;let a=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.moveUnit=100,this.rotUnit=100,this.deadzone=cc.Vec2.ZERO,this.touchArea=null,this.arena=null,this.startPoint=cc.Vec2.ZERO,this.movePoint=cc.Vec2.ZERO,this.isActive=!1}onLoad(){this.arena||(this.arena=this.getComponent(i.default)),this.arena.node.on("resumed",this.onResume,this),this.arena.node.on("started",this.checkControls,this),this.checkControls()}onEnable(){this.registerEvents()}onDisable(){this.unregisterEvents()}update(e){this.isActive&&(this.arena.level.moveByHandler(this.movePoint.y/this.moveUnit),this.arena.level.tiltToHandler(-this.movePoint.x/this.rotUnit))}onResume(){this.checkControls()}checkControls(){this.enabled=n.default.instance.settings.controls[ControlType.Touch]}registerEvents(){this.touchArea.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touchArea.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touchArea.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.touchArea.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)}unregisterEvents(){this.touchArea.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touchArea.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touchArea.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.touchArea.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)}onTouchStart(e){cc.log("touch start id"+e.getID()),e.getID()<1&&(this.startPoint=e.getLocation(),this.isActive=!0)}onTouchMove(e){if(e.getID()<1){let t=e.getLocation();this.movePoint=t.sub(this.startPoint),Math.abs(this.movePoint.x)<this.deadzone.x&&(this.movePoint.x=0),Math.abs(this.movePoint.y)<this.deadzone.y&&(this.movePoint.y=0),this.movePoint.clampf(cc.v2(-this.rotUnit,-this.moveUnit),cc.v2(this.rotUnit,this.moveUnit))}}onTouchEnd(e){cc.log("touch end id"+e.getID()),e.getID()<1&&(this.startPoint=cc.Vec2.ZERO,this.movePoint.y=0,this.isActive=!1)}};return o([r({type:cc.Integer,min:1})],e.prototype,"moveUnit",void 0),o([r({type:cc.Integer,min:1})],e.prototype,"rotUnit",void 0),o([r(cc.Vec2)],e.prototype,"deadzone",void 0),o([r(cc.Node)],e.prototype,"touchArea",void 0),o([r(cc.Node)],e.prototype,"arena",void 0),o([c],e)})();s.default=a,cc._RF.pop()},{"./Arena":"Arena","./Game":"Game"}],TransitionBtn:[function(e,t,s){"use strict";cc._RF.push(t,"707db31qNBH35pDOwDM7u3n","TransitionBtn");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const{ccclass:i,property:n,requireComponent:c}=cc._decorator;let r=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.target=null,this.resetTween=null,this.hoverTween=null,this.pressedTween=null,this.btn=null}onLoad(){this.btn=this.getComponent(cc.Button),this.target||(this.target=this.btn.target),this.registerEvents()}onDestroy(){this.unregisterEvents()}registerEvents(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.node.on(cc.Node.EventType.MOUSE_ENTER,this.onHoverIn,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onHoverOut,this)}unregisterEvents(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.node.off(cc.Node.EventType.MOUSE_ENTER,this.onHoverIn,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.onHoverOut,this)}hide(){this.node.active=!1}show(){this.node.active=!0}click(){this.clickDown(),this.clickUp()}clickDown(){this.btn.node.dispatchEvent(new cc.Event.EventCustom("touchstart",!0))}clickUp(){this.btn.node.dispatchEvent(new cc.Event.EventCustom("touchend",!0))}enable(){this.enabled||(this.enabled=!0)}disable(){this.enabled&&(this.enabled=!1)}onTouchStart(e){this.pressedTween&&this.btn.interactable&&this.pressedTween.start()}onTouchEnd(e){this.pressedTween&&this.btn.interactable&&(this.pressedTween.stop(),this.resetTween.start())}onHoverIn(){this.hoverTween&&this.btn.interactable&&this.hoverTween.start()}onHoverOut(){this.hoverTween&&this.btn.interactable&&(this.hoverTween.stop(),this.resetTween.start())}};return o([n(cc.Node)],e.prototype,"target",void 0),o([i,c(cc.Button)],e)})();s.default=r,cc._RF.pop()},{}],TranslateTransitionBtn:[function(e,t,s){"use strict";cc._RF.push(t,"07c7fRC/yxMU7mmXCoc7zKa","TranslateTransitionBtn");var o=this&&this.__decorate||function(e,t,s,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(c=(n<3?i(c):n>3?i(t,s,c):i(t,s))||c);return n>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(s,"__esModule",{value:!0});const i=e("./TransitionBtn"),{ccclass:n,property:c,requireComponent:r}=cc._decorator;let a=(()=>{let e=class extends i.default{constructor(){super(...arguments),this.hoverDelta=cc.Vec2.ZERO,this.pressedDelta=cc.Vec2.ZERO,this.duration=.1,this.easing="linear",this.startPos=cc.Vec2.ZERO}registerEvents(){super.registerEvents(),this.startPos=this.target.position,this.resetTween=cc.tween(this.target).to(this.duration,{position:this.startPos},{easing:this.easing}),this.hoverDelta.mag()&&(this.hoverTween=cc.tween(this.target).to(this.duration,{position:this.startPos.add(this.hoverDelta)},{easing:this.easing})),this.pressedDelta.mag()&&(this.pressedTween=cc.tween(this.target).to(this.duration,{position:this.startPos.add(this.pressedDelta)},{easing:this.easing}))}};return o([c(cc.Vec2)],e.prototype,"hoverDelta",void 0),o([c(cc.Vec2)],e.prototype,"pressedDelta",void 0),o([c({type:cc.Float,min:0})],e.prototype,"duration",void 0),o([c],e.prototype,"easing",void 0),o([n,r(cc.Button)],e)})();s.default=a,cc._RF.pop()},{"./TransitionBtn":"TransitionBtn"}],use_reversed_rotateTo:[function(e,t){"use strict";cc._RF.push(t,"41524fHi+FDLIk6kRxUoulC","use_reversed_rotateTo"),cc.RotateTo._reverse=!0,cc._RF.pop()},{}]},{},["Accelerator","Arena","BackgroundGrad","Ball","BallSpawner","Block","CollisionHandler","EndlessArena","EndlessLevel","Game","Gameplay","Gem","Globals","GradientBg","Hole","HoleField","HoleSpawner","GravityHole","MovingHole","TargetHole","KeyInputAxis","KeyboardInput","Level","LevelsArena","LiftUp","MathModule","NodeEventsHandlers","RandomHoleField","RecordLine","SoundManager","TN_BGAdapter","TiltInputAxis","TimeLevel","TouchInputAxis","ColorToggler","ContentFitter","LevelBtn","MainUI","NavigationBtn","NavigationPanel","RadioBtn","SettingUI","SpriteToggleBtn","ToggleBtn","TransitionBtn","TranslateTransitionBtn","use_reversed_rotateTo"]);