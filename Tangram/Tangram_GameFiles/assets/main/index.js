window.__require=function e(t,o,n){function i(r,c){if(!o[r]){if(!t[r]){var l=r.split("/");if(l=l[l.length-1],!t[l]){var s="function"==typeof __require&&__require;if(!c&&s)return s(l,!0);if(a)return a(l,!0);throw new Error("Cannot find module '"+r+"'")}r=l}var p=o[r]={exports:{}};t[r][0].call(p.exports,function(e){return i(t[r][1][e]||e)},p,p.exports,e,t,o,n)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<n.length;r++)i(n[r]);return i}({BundleInfo:[function(e,t,o){"use strict";cc._RF.push(t,"2378cxSEtNNhohw5aXF/HhI","BundleInfo");var n=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./PackInfo"),a=cc._decorator,r=a.ccclass,c=a.property,l=function(){function e(){this.bundleName="",this.packListItemPrefab=null,this.packInfos=[]}return n([c()],e.prototype,"bundleName",void 0),n([c(cc.Prefab)],e.prototype,"packListItemPrefab",void 0),n([c(i.default)],e.prototype,"packInfos",void 0),n([r],e)}();o.default=l,cc._RF.pop()},{"./PackInfo":"PackInfo"}],BundleScreen:[function(e,t,o){"use strict";cc._RF.push(t,"cc289wWlHJJOaru99hyyZpy","BundleScreen");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Framework/Scripts/Utilities/ObjectPool"),c=e("../Game/GameManager"),l=e("../UI/PackListItem"),s=e("./LevelListScreen"),p=e("../../Framework/Scripts/Screen/ScreenManager"),d=cc._decorator,h=d.ccclass,u=d.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.leftBundleButton=null,t.rightBundleButton=null,t.packListContainer=null,t.packListScrollRect=null,t.gameManager=null,t.bundleScreen=null,t.levelScreen=null,t.screenManagerNode=null,t.packListPools=[],t.packListItemArr=[],t.count=0,t}return i(t,e),Object.defineProperty(t.prototype,"ActivePackListContainer",{get:function(){return this.activePackListContainer},set:function(e){this.activePackListContainer=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NonActivePackListContainer",{get:function(){return this.packListContainerClone==this.ActivePackListContainer?this.packListContainer:this.packListContainerClone},enumerable:!1,configurable:!0}),t.prototype.start=function(){var e=r.default.CreatePoolContainer(this.node);this.packListContainerClone=cc.instantiate(this.packListContainer),this.packListPools=new Array;for(var t=0;t<this.gameManager.getComponent(c.default).BundleInfos.length;t++){var o=this.gameManager.getComponent(c.default).BundleInfos[t];this.packListPools.push(new r.default(o.packListItemPrefab,1,e))}this.previousBundleIndex=-1,this.ActivePackListContainer=this.packListContainer,this.SetBundleIndex(0)},t.prototype.Show=function(){this.UpdateUI(!1)},t.prototype.OnLeftButtonClicked=function(){this.isAnimatingContainers||(this.previousBundleIndex=this.currentBundleIndex,this.SetBundleIndex(this.currentBundleIndex-1),this.UpdateUI(!1))},t.prototype.OnRightButtonClicked=function(){this.isAnimatingContainers||(this.previousBundleIndex=this.currentBundleIndex,this.SetBundleIndex(this.currentBundleIndex+1),this.UpdateUI(!1))},t.prototype.SetBundleIndex=function(e){this.currentBundleIndex=e,this.UpdateUI(!1)},t.prototype.UpdateUI=function(e){var t=e?this.NonActivePackListContainer:this.ActivePackListContainer;r.default.ReturnChildObjectsToPool(t);var o=this.gameManager.getComponent(c.default).BundleInfos[this.currentBundleIndex];this.UpdateBundleHeader(o,e);for(var n=0;n<o.packInfos.length;n++){var i=o.packInfos[n],a=this.packListPools[this.currentBundleIndex].GetObjectPackList(t);a.Setup(i),a.Data=i;var l=new cc.Component.EventHandler;l.target=this.node,l.component="BundleScreen",l.handler="OnButtonPressed",a.node.getComponent(cc.Button).clickEvents.push(l),this.count<=4&&(this.count++,this.packListItemArr.push(a))}this.packListScrollRect.content=t,t.setPosition(cc.v2(t.position.x,0)),this.ActivePackListContainer=t},t.prototype.OnButtonPressed=function(e){var t=e.currentTarget.getComponent(l.default).Data;this.currentPackInfo=t,this.bundleScreen.active=!1,this.screenManagerNode.getComponent(p.default).soundManager.buttonClickSound(),this.levelScreen.getComponent(s.default).difficultyTextNode.active=!0,this.levelScreen.getComponent(s.default).headerTextNode.y=-67,this.levelScreen.getComponent(s.default).headerTextNode.getComponent(cc.Label).string=t.packName,this.levelScreen.getComponent(s.default).UpdateList(t),this.levelScreen.active=!0,this.screenManagerNode.getComponent(p.default).backStack.push(this.levelScreen)},t.prototype.AnimateListOffScreen=function(e){this.previousBundleIndex,this.currentBundleIndex,e.width},t.prototype.UpdateBundleHeader=function(){this.leftBundleButton.interactable=this.currentBundleIndex>0,this.rightBundleButton.interactable=this.currentBundleIndex<this.gameManager.getComponent(c.default).BundleInfos.length-1},a([u(cc.Button)],t.prototype,"leftBundleButton",void 0),a([u(cc.Button)],t.prototype,"rightBundleButton",void 0),a([u(cc.Node)],t.prototype,"packListContainer",void 0),a([u(cc.ScrollView)],t.prototype,"packListScrollRect",void 0),a([u(cc.Node)],t.prototype,"gameManager",void 0),a([u(cc.Node)],t.prototype,"bundleScreen",void 0),a([u(cc.Node)],t.prototype,"levelScreen",void 0),a([u(cc.Node)],t.prototype,"screenManagerNode",void 0),a([u(cc.Node)],t.prototype,"ActivePackListContainer",null),a([u],t.prototype,"NonActivePackListContainer",null),a([h],t)}(cc.Component);o.default=v,cc._RF.pop()},{"../../Framework/Scripts/Screen/ScreenManager":"ScreenManager","../../Framework/Scripts/Utilities/ObjectPool":"ObjectPool","../Game/GameManager":"GameManager","../UI/PackListItem":"PackListItem","./LevelListScreen":"LevelListScreen"}],GameArea:[function(e,t,o){"use strict";cc._RF.push(t,"10242Ss3nlN2Lqr3mTSWAPY","GameArea");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./GameManager"),c=e("../../Framework/Scripts/Utilities/ObjectPool"),l=e("../../Framework/Scripts/Sound/SoundManager"),s=cc._decorator,p=s.ccclass,d=s.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.polygonImagePrefab=null,t.boardContainer=null,t.polygonContainer=null,t.soundManager=null,t.hintBtn=null,t.resetBtn=null,t.beginner_sprite=null,t.beginner_sprite_1=null,t.easy_sprite=null,t.easy_sprite_1=null,t.medium_sprite=null,t.medium_sprite_1=null,t.hard_sprite=null,t.hard_sprite_1=null,t.expert_sprite=null,t.expert_sprite_1=null,t.spaceBetweenContainers=25,t.polygonsInRow=5,t.polygonsFitCell=!1,t.polygonColors=[cc.color(255,51,51),cc.color(51,255,68),cc.color(85,51,255),cc.color(255,136,51),cc.color(51,255,154),cc.color(170,51,255),cc.color(255,221,51),cc.color(51,255,238),cc.color(255,51,255),cc.color(204,255,51),cc.color(51,187,255),cc.color(255,51,170),cc.color(119,255,51),cc.color(51,102,55)],t.hintMinAlpha=0,t.hintMaxAlpha=255,t.hintObjectArr=[],t.gridPosition=cc.v2(),t.gameManager=null,t.gridPosition1=cc.v2(),t}return i(t,e),t.prototype.Initialize=function(){this.polygonObjects=new Array,this.hintPolygonObjects=new Array,this.polygonImagePool=new c.default(this.polygonImagePrefab,0,c.default.CreatePoolContainer(this.node,"polygon_image_pool")),this.placedPolygonsContainer=this.CreateBoardContainer("placed_polygons_container"),this.placedPolygonsContainer.addComponent(cc.MeshRenderer),this.polygonHintsContainer=this.CreateBoardContainer("polygon_hints_container")},t.prototype.SetupLevel=function(e,t){this.ActiveLevelSaveData=t,this.activeLevelData=e,this.activeLevelData.LevelIndex<3e3&&(this.activeLevelData.LevelIndex<2e3?this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.beginner_sprite:this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.beginner_sprite_1),this.activeLevelData.LevelIndex>=3e3&&this.activeLevelData.LevelIndex<5e3&&(this.activeLevelData.LevelIndex<4e3?this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.easy_sprite:this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.easy_sprite_1),this.activeLevelData.LevelIndex>=5e3&&this.activeLevelData.LevelIndex<7e3&&(this.activeLevelData.LevelIndex<6e3?this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.medium_sprite:this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.medium_sprite_1),this.activeLevelData.LevelIndex>=7e3&&this.activeLevelData.LevelIndex<9e3&&(this.activeLevelData.LevelIndex<8e3?this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.hard_sprite:this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.hard_sprite_1),this.activeLevelData.LevelIndex>=9e3&&this.activeLevelData.LevelIndex<11e3&&(this.activeLevelData.LevelIndex<1e4?this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.expert_sprite:this.boardContainer.getComponent(cc.Sprite).spriteFrame=this.expert_sprite_1),this.SizeAndPositionContainers(),this.Clear(),this.polygonScale=this.boardContainer.width/e.GridSize,this.SetupPolygonContainer(e.PolygonDatas.length),this.CreatePolygonImages(e)},t.prototype.DisplayHint=function(e){var t=this.CreatePolygonObject(this.activeLevelData,e,!1,!0);t.polygonImage.node.off(cc.Node.EventType.TOUCH_MOVE,this.handleTouchMove,this),t.polygonImage.node.off(cc.Node.EventType.TOUCH_START,this.handleTouchStart,this),t.polygonImage.node.off(cc.Node.EventType.TOUCH_END,this.handleTouchEnd,this),t.polygonImage.node.off(cc.Node.EventType.TOUCH_CANCEL,this.handleTouchEnd,this),this.hintPolygonObjects.push(t);var o=t.polygonImage.node.color,n=t.polygonImage.node.color;o.a=this.hintMinAlpha,n.a=this.hintMaxAlpha,this.hintObjectArr.push(t),this.doBlinkAnimationforHint(this.hintObjectArr,o,n);var i=this.activeLevelData.PolygonDatas[e];this.MovePolygonToBoard(t,cc.v2(i.gridBounds.x,i.gridBounds.y),!0)},t.prototype.doBlinkAnimationforHint=function(e){e.forEach(function(e){cc.tween(e.polygonImage.node).repeatForever(cc.blink(6,6)).start()})},t.prototype.SizeAndPositionContainers=function(){this.boardContainer.setAnchorPoint(cc.v2(.5,.5)),this.polygonContainer.setAnchorPoint(cc.v2(.5,.5));var e=this.node.width;this.node.height,this.spaceBetweenContainers;this.node.height,this.node.height},t.prototype.CreateBoardContainer=function(e){var t=new cc.Node(e);return t.parent=this.boardContainer,t.setContentSize(this.boardContainer.getContentSize()),t},t.prototype.OnActiveLevelCompleted=function(){this.activeLevelData=null},t.prototype.Clear=function(){this.polygonImagePool.ReturnAllObjectsToPool();for(var e=0;e<this.polygonObjects.length;e++)this.polygonObjects[e].polygonContainerMarker.destroy();for(e=0;e<this.hintPolygonObjects.length;e++);this.polygonObjects.length=0,this.hintPolygonObjects.length=0},t.prototype.SetupPolygonContainer=function(e){this.polygonContainer.getComponent(cc.Layout).paddingLeft=5.2604,this.polygonContainer.getComponent(cc.Layout).paddingRight=5.2604,this.polygonContainer.getComponent(cc.Layout).spacingX=5.2604,this.polygonContainer.getComponent(cc.Layout).spacingY=5.2604;for(var t=this.polygonsInRow,o=1,n=!0;e>o*t;)n?o++:t++,n=!n;this.activeLevelData.LevelIndex>=3e3&&this.activeLevelData.LevelIndex<5051||7029==this.activeLevelData.LevelIndex||7046==this.activeLevelData.LevelIndex||this.activeLevelData.LevelIndex>=1e4&&this.activeLevelData.LevelIndex<10051?this.polygonContainer.getComponent(cc.Layout).startAxis=cc.Layout.AxisDirection.HORIZONTAL:this.polygonContainer.getComponent(cc.Layout).startAxis=cc.Layout.AxisDirection.VERTICAL,4032==this.activeLevelData.LevelIndex||4041==this.activeLevelData.LevelIndex||4007==this.activeLevelData.LevelIndex?(this.polygonContainer.getComponent(cc.Layout).paddingTop=18.90966,this.polygonContainer.getComponent(cc.Layout).spacingY=18.2604*1.65):(this.polygonContainer.getComponent(cc.Layout).paddingTop=5.2604,this.polygonContainer.getComponent(cc.Layout).spacingY=5.2604),3028!=this.activeLevelData.LevelIndex&&3041!=this.activeLevelData.LevelIndex&&4011!=this.activeLevelData.LevelIndex&&4017!=this.activeLevelData.LevelIndex&&4021!=this.activeLevelData.LevelIndex&&4026!=this.activeLevelData.LevelIndex&&4034!=this.activeLevelData.LevelIndex&&4036!=this.activeLevelData.LevelIndex&&4038!=this.activeLevelData.LevelIndex&&4046!=this.activeLevelData.LevelIndex||(this.polygonContainer.getComponent(cc.Layout).paddingTop=16.92966,this.polygonContainer.getComponent(cc.Layout).spacingY=7.2604*1.65),4036!=this.activeLevelData.LevelIndex&&3024!=this.activeLevelData.LevelIndex||(this.polygonContainer.getComponent(cc.Layout).paddingTop=5.2604*1.65,this.polygonContainer.getComponent(cc.Layout).spacingY=18.2604),5005!=this.activeLevelData.LevelIndex&&5033!=this.activeLevelData.LevelIndex&&5036!=this.activeLevelData.LevelIndex&&5037!=this.activeLevelData.LevelIndex&&5038!=this.activeLevelData.LevelIndex&&5045!=this.activeLevelData.LevelIndex&&5046!=this.activeLevelData.LevelIndex||(this.polygonContainer.getComponent(cc.Layout).paddingTop=16.92966,this.polygonContainer.getComponent(cc.Layout).paddingBottom=0,this.polygonContainer.getComponent(cc.Layout).spacingY=21.87966),5038!=this.activeLevelData.LevelIndex&&5046!=this.activeLevelData.LevelIndex||(this.polygonContainer.getComponent(cc.Layout).paddingTop=4.2604*1.65,this.polygonContainer.getComponent(cc.Layout).paddingBottom=7*1.65),5045==this.activeLevelData.LevelIndex&&(this.polygonContainer.getComponent(cc.Layout).paddingTop=23.52966),6010!=this.activeLevelData.LevelIndex&&6013!=this.activeLevelData.LevelIndex&&6032!=this.activeLevelData.LevelIndex||(this.polygonContainer.getComponent(cc.Layout).paddingTop=4.2604*1.65,this.polygonContainer.getComponent(cc.Layout).spacingY=21.87966,this.polygonContainer.getComponent(cc.Layout).paddingBottom=7*1.65),7025==this.activeLevelData.LevelIndex&&(this.polygonContainer.getComponent(cc.Layout).paddingTop=0,this.polygonContainer.getComponent(cc.Layout).paddingBottom=16.92966,this.polygonContainer.getComponent(cc.Layout).spacingY=16.92966),7029!=this.activeLevelData.LevelIndex&&7036!=this.activeLevelData.LevelIndex||(this.polygonContainer.getComponent(cc.Layout).paddingTop=0,this.polygonContainer.getComponent(cc.Layout).paddingBottom=18.57966,this.polygonContainer.getComponent(cc.Layout).spacingY=13.62966),7046==this.activeLevelData.LevelIndex&&(this.polygonContainer.getComponent(cc.Layout).paddingTop=25.17966,this.polygonContainer.getComponent(cc.Layout).paddingBottom=0,this.polygonContainer.getComponent(cc.Layout).spacingY=18.2604*1.65),10032==this.activeLevelData.LevelIndex&&(this.polygonContainer.getComponent(cc.Layout).paddingTop=16.92966,this.polygonContainer.getComponent(cc.Layout).paddingBottom=0,this.polygonContainer.getComponent(cc.Layout).spacingY=5.2604*1.65),10034==this.activeLevelData.LevelIndex&&(this.polygonContainer.getComponent(cc.Layout).paddingBottom=16.92966,this.polygonContainer.getComponent(cc.Layout).spacingY=5.2604*1.65),10003!=this.activeLevelData.LevelIndex&&10006!=this.activeLevelData.LevelIndex||(this.polygonContainer.getComponent(cc.Layout).paddingTop=10.2604,this.polygonContainer.getComponent(cc.Layout).paddingBottom=0),10010!=this.activeLevelData.LevelIndex&&10021!=this.activeLevelData.LevelIndex||(this.polygonContainer.getComponent(cc.Layout).spacingY=6.2604*1.65),10022!=this.activeLevelData.LevelIndex&&10008!=this.activeLevelData.LevelIndex||(this.polygonContainer.getComponent(cc.Layout).paddingTop=10.2604,this.polygonContainer.getComponent(cc.Layout).paddingBottom=0,this.polygonContainer.getComponent(cc.Layout).spacingY=5.2604*1.65);var i=cc.v2(this.polygonContainer.width,this.polygonContainer.height),a=(i.x-this.polygonContainer.getComponent(cc.Layout).spacingX*(t-1)-this.polygonContainer.getComponent(cc.Layout).paddingLeft-this.polygonContainer.getComponent(cc.Layout).paddingRight)/t,r=(i.y-this.polygonContainer.getComponent(cc.Layout).spacingY*(o-1)-this.polygonContainer.getComponent(cc.Layout).paddingTop-this.polygonContainer.getComponent(cc.Layout).paddingBottom)/o;4032!=this.activeLevelData.LevelIndex&&4041!=this.activeLevelData.LevelIndex||(r=42.77948399999999),6010!=this.activeLevelData.LevelIndex&&6013!=this.activeLevelData.LevelIndex&&6032!=this.activeLevelData.LevelIndex||(r=52.67948399999999),this.polygonContainer.width-a*e>5.2604*6&&(this.polygonContainer.getComponent(cc.Layout).paddingLeft+=(this.polygonContainer.width-a*e-5.2604*6)/2,this.polygonContainer.getComponent(cc.Layout).paddingRight+=(this.polygonContainer.width-a*e-5.2604*6)/2),this.polygonContainer.getComponent(cc.Layout).cellSize=cc.size(a,r)},t.prototype.CreatePolygonImages=function(e){this.polygonContainerScale=Number.MAX_VALUE;for(var t=0;t<e.PolygonDatas.length;t++){e.PolygonDatas[t];var o=this.CreatePolygonObject(e,t);this.polygonObjects.push(o),o.polygonContainerMarker=new cc.Node("polygon_marker"),o.polygonContainerMarker.parent=this.polygonContainer,o.polygonContainerMarker.setContentSize(this.polygonContainer.getContentSize());var n=o.polygonImage.node.width,i=o.polygonImage.node.width,a=Math.abs(this.polygonContainer.getComponent(cc.Layout).cellSize.width-n)>Math.abs(this.polygonContainer.getComponent(cc.Layout).cellSize.height-i)?this.polygonContainer.getComponent(cc.Layout).cellSize.width/n:this.polygonContainer.getComponent(cc.Layout).cellSize.height/i;this.polygonsFitCell?o.polygonContainerMarker.setScale(new cc.Vec3(a,a,1)):this.polygonContainerScale=Math.min(this.polygonContainerScale,a)}for(t=0;t<this.polygonObjects.length;t++)this.MoveToPolygonMarker(this.polygonObjects[t])},t.prototype.CreatePolygonObject=function(e,t,o,n){var i=e.PolygonDatas[t],a=this.polygonImagePool.GetObject();this.SetPolygonVisuals(a,t),o?a.Setup(i,this.polygonScale,this.boardContainer.width,!0):n?a.Setup(i,this.polygonScale,this.boardContainer.width,!1,!0):a.Setup(i,this.polygonScale,this.boardContainer.width);var r=new u;return r.index=t,r.polygonImage=a,r.polygonImage.node.on(cc.Node.EventType.TOUCH_MOVE,this.handleTouchMove,this),r.polygonImage.node.on(cc.Node.EventType.TOUCH_START,this.handleTouchStart,this),r.polygonImage.node.on(cc.Node.EventType.TOUCH_END,this.handleTouchEnd,this),r.polygonImage.node.on(cc.Node.EventType.TOUCH_CANCEL,this.handleTouchEnd,this),r},t.prototype.handleTouchStart=function(e){if(this.hintBtn.getComponent(cc.Button).enabled=!1,this.resetBtn.getComponent(cc.Button).enabled=!1,!this.isPointerActive&&null!=this.activeLevelData){this.soundManager.shapeSelectedSound(),this.isPointerActive=!0,this.activePointerId=e.getID();var t=e.getLocation();this.boardContainer.getBoundingBoxToWorld().contains(t)?this.TryStartDraggingPolygonOnBoard(t):this.polygonContainer.getBoundingBoxToWorld().contains(t)&&this.TryStartDraggingPolygonInContainer(t),null!=this.activePolygonObject&&(this.activePolygonObjectGhost=this.CreatePolygonObject(this.activeLevelData,this.activePolygonObject.index,!0),this.activePolygonObjectGhost.polygonImage.node.active=!1)}},t.prototype.handleTouchMove=function(e){this.isPointerActive&&e.getID()==this.activePointerId&&null!=this.activePolygonObject&&(this.UpdateActivePolygonObjectPosition(e.getLocation()),cc.v2(),this.TryGetValidGridPosition(this.gridPosition)?(this.activePolygonObjectGhost.polygonImage.node.active=!0,this.MovePolygonToBoard(this.activePolygonObjectGhost,this.gridPosition,!1)):this.activePolygonObjectGhost.polygonImage.node.active=!1)},t.prototype.handleTouchEnd=function(e){var t=this;this.hintBtn.getComponent(cc.Button).enabled=!0,this.resetBtn.getComponent(cc.Button).enabled=!0,this.isPointerActive&&e.getID()==this.activePointerId&&(null!=this.activePolygonObject&&(this.TryGetValidGridPosition(this.gridPosition1)?(this.soundManager.shapePlacedSound(),this.MovePolygonToBoard(this.activePolygonObject,this.gridPosition1,!1),this.gameManager.PolygonPlacedOnBoard(this.activePolygonObject.index,cc.v2(this.gridPosition.x,this.gridPosition.y),this.ActiveLevelSaveData,this.activeLevelData),this.hintPolygonObjects.forEach(function(e,o){var n;e.index==t.activePolygonObject.index&&cc.Vec2.equals(cc.v2(e.polygonImage.node.x,e.polygonImage.node.y),cc.v2(t.activePolygonObject.polygonImage.node.x,t.activePolygonObject.polygonImage.node.y))&&(t.boardContainer.children[1].children.forEach(function(i){i.color.r==t.activePolygonObject.polygonImage.node.color.r&&i.color.g==t.activePolygonObject.polygonImage.node.color.g&&i.color.b==t.activePolygonObject.polygonImage.node.color.b&&(n=t.ActiveLevelSaveData.hintsDisplayed.findIndex(function(t){return t==e.index}),t.hintPolygonObjects.splice(o,1),i.removeFromParent())}),-1!=n&&t.ActiveLevelSaveData.hintsDisplayed.splice(n,1))})):(this.MoveToPolygonMarker(this.activePolygonObject),this.gameManager.PolygonRemovedFromBoard(this.activePolygonObject.index,this.ActiveLevelSaveData,this.activeLevelData)),c.default.ReturnObjectToPool(this.activePolygonObjectGhost.polygonImage.node)),this.isPointerActive=!1,this.activePolygonObject=null)},t.prototype.SetPolygonVisuals=function(e,t){e.node.color=this.polygonColors[t%this.polygonColors.length],this.SetPolygonAlpha(e,255)},t.prototype.SetPolygonAlpha=function(e,t){var o=e.node.color;o.a=t,e.node.color=o},t.prototype.MoveToPolygonMarker=function(e,t){void 0===t&&(t=!1),e.polygonImage.node.parent=e.polygonContainerMarker,e.polygonImage.node.setPosition(cc.v2(0,0)),e.polygonImage.node.setScale(this.polygonsFitCell?cc.Vec3.ONE:new cc.Vec3(this.polygonContainerScale,this.polygonContainerScale,1))},t.prototype.TryStartDraggingPolygonInContainer=function(e){cc.v3(e.x,e.y,1);for(var t=null,o=0;o<this.polygonObjects.length;o++){var n=this.polygonObjects[o];n.polygonContainerMarker.getBoundingBoxToWorld().contains(e)&&(t=n)}return null!=t&&!t.isOnBoard&&(this.SetPolygonObjectAsActive(t,e),!0)},t.prototype.SetPolygonObjectAsActive=function(e,t){this.activePolygonObject=e,this.boardContainer.insertChild(this.activePolygonObject.polygonImage.node,0),this.activePolygonObject.polygonImage.node.scale=1,this.UpdateActivePolygonObjectPosition(t)},t.prototype.UpdateActivePolygonObjectPosition=function(e){var t;(t=this.node.parent.parent.parent.convertToNodeSpaceAR(e)).y+=this.activePolygonObject.polygonImage.node.height*this.activePolygonObject.polygonImage.node.scaleY/2,this.activePolygonObject.polygonImage.node.setPosition(cc.v2(t.x,t.y-90))},t.prototype.TryGetValidGridPosition=function(e){var t=this.activePolygonObject.polygonImage.node.getBoundingBox(),o=this.node.parent.parent.parent.convertToWorldSpaceAR(cc.v3(this.activePolygonObject.polygonImage.node.position.x,this.activePolygonObject.polygonImage.node.position.y+90,this.activePolygonObject.polygonImage.node.position.z)),n=this.boardContainer.convertToNodeSpaceAR(o),i=cc.v2(n.x,n.y);if(this.boardContainer.getBoundingBox().contains(cc.v2(this.activePolygonObject.polygonImage.node.position.x,this.activePolygonObject.polygonImage.node.position.y+90))&&this.activePolygonObject.polygonImage.node.getBoundingBoxToWorld().yMin>230){var a=cc.v2(t.size.width,t.size.height);i=cc.Vec2.subtract(i,i,cc.Vec2.divide(a,a,cc.v2(2,2)));var r=cc.v2(this.boardContainer.getBoundingBox().size.width,this.boardContainer.getBoundingBox().size.height);if((i=cc.Vec2.add(i,i,cc.Vec2.divide(r,r,cc.v2(2,2)))).x=cc.misc.clampf(i.x,0,this.boardContainer.getBoundingBox().size.width-t.size.width),i.y=cc.misc.clampf(i.y,0,this.boardContainer.getBoundingBox().size.height-t.size.height),e.x=Math.round(i.x/this.polygonScale),e.y=Math.round(i.y/this.polygonScale),this.gridPosition.x=Math.round(i.x/this.polygonScale),this.gridPosition.y=Math.round(i.y/this.polygonScale),this.CanPlaceActivePolygonOnGridAt(cc.v2(e.x,e.y)))return!0}return e.x=0,e.y=0,this.gridPosition.x=0,this.gridPosition.y=0,!1},t.prototype.CanPlaceActivePolygonOnGridAt=function(e){for(var t=0;t<this.polygonObjects.length;t++)if(t!=this.activePolygonObject.index){var o=this.polygonObjects[t];if(o.isOnBoard&&this.CheckPolygonsOverlap(this.activePolygonObject,o,e))return!1}return!0},t.prototype.CheckPolygonsOverlap=function(e,t,o){3013==this.activeLevelData.LevelIndex||3046==this.activeLevelData.LevelIndex||2010==this.activeLevelData.LevelIndex?this.polygonObject_Temp=t:this.polygonObject_Temp=null;var n=this.activeLevelData.PolygonDatas[e.index],i=this.activeLevelData.PolygonDatas[t.index],a=t.gridPosition,r=o,c=cc.v2(o.x+n.gridBounds.size.width,o.y+n.gridBounds.size.height),l=a,s=cc.v2(a.x+i.gridBounds.size.width,a.y+i.gridBounds.size.height);if(!this.RectanglesOverlap(r,c,l,s))return!1;for(var p=0;p<n.triangles.length;p++)for(var d=n.triangles[p],h=0;h<i.triangles.length;h++){var u=i.triangles[h];if(this.TrianglesOverlap(d,u,o,a))return!0}return!1},t.prototype.RectanglesOverlap=function(e,t,o,n){return!(e.x>=n.x||t.x<=o.x||e.y>=n.y||t.y<=o.y)},t.prototype.TrianglesOverlap=function(e,t,o,n){var i=cc.v2();cc.Vec2.add(i,new cc.Vec2(e.Bounds.xMin,e.Bounds.yMin),o);var a=cc.v2();cc.Vec2.add(a,new cc.Vec2(e.Bounds.xMax,e.Bounds.yMax),o);var r=cc.v2();cc.Vec2.add(r,new cc.Vec2(t.Bounds.xMin,t.Bounds.yMin),n);var c=cc.v2();if(cc.Vec2.add(c,new cc.Vec2(t.Bounds.xMax,t.Bounds.yMax),n),!this.RectanglesOverlap(i,a,r,c))return!1;var l=cc.v2();cc.Vec2.add(l,e.p1,o);var s=cc.v2();cc.Vec2.add(s,e.p2,o);var p=cc.v2();cc.Vec2.add(p,e.p3,o);var d=cc.v2();cc.Vec2.add(d,t.p1,n);var h=cc.v2();cc.Vec2.add(h,t.p2,n);var u=cc.v2();return cc.Vec2.add(u,t.p3,n),this.LinesIntersect(l,s,d,h)||this.LinesIntersect(l,s,d,u)||this.LinesIntersect(l,s,h,u)||this.LinesIntersect(l,p,d,h)||this.LinesIntersect(l,p,d,u)||this.LinesIntersect(l,p,h,u)||this.LinesIntersect(s,p,d,h)||this.LinesIntersect(s,p,d,u)||this.LinesIntersect(s,p,h,u)},t.prototype.LinesIntersect=function(e,t,o,n){var i=((n.x-o.x)*(e.y-o.y)-(n.y-o.y)*(e.x-o.x))/((n.y-o.y)*(t.x-e.x)-(n.x-o.x)*(t.y-e.y)),a=((t.x-e.x)*(e.y-o.y)-(t.y-e.y)*(e.x-o.x))/((n.y-o.y)*(t.x-e.x)-(n.x-o.x)*(t.y-e.y));return 1020==this.activeLevelData.LevelIndex?i>0&&i<1&&a>=0&&a<=1:3046!=this.activeLevelData.LevelIndex||3!=this.activePolygonObject.index&&4!=this.activePolygonObject.index||4!=this.polygonObject_Temp.index&&3!=this.polygonObject_Temp.index?(2010!=this.activeLevelData.LevelIndex||0!=this.activePolygonObject.index&&4!=this.activePolygonObject.index||4!=this.polygonObject_Temp.index&&0!=this.polygonObject_Temp.index)&&(3013!=this.activeLevelData.LevelIndex||0!=this.activePolygonObject.index&&1!=this.activePolygonObject.index||1!=this.polygonObject_Temp.index&&0!=this.polygonObject_Temp.index)?6010==this.activeLevelData.LevelIndex?i>0&&i<1&&a>=0&&a<=1:i>0&&i<1&&a>=0&&a<1:i>0&&i<=1&&a>=0&&a<1:i>=0&&i<1&&a>=0&&a<1},t.prototype.IsPointInTriangle=function(e,t,o,n){if(cc.Vec2.equals(e,t)||cc.Vec2.equals(e,o)||cc.Vec2.equals(e,n))return!1;var i=this.Sign(e,t,o),a=this.Sign(e,o,n),r=this.Sign(e,n,t);return!((i<0||a<0||r<0)&&(i>0||a>0||r>0))},t.prototype.Sign=function(e,t,o){return(e.x-o.x)*(t.y-o.y)-(t.x-o.x)*(e.y-o.y)},t.prototype.MovePolygonToBoard=function(e,t,o){var n=this;e.gridPosition=cc.v2(t.x,t.y);var i=e.polygonImage.node,a=o?this.polygonHintsContainer:this.placedPolygonsContainer;i.parent=a,i.setScale(cc.Vec3.ONE);var r=cc.v2(i.getBoundingBox().size.width/2,i.getBoundingBox().size.height/2),c=cc.v2(this.boardContainer.getBoundingBox().size.width/2,this.boardContainer.getBoundingBox().size.height/2),l=cc.Vec2.subtract(r,r,c),s=cc.Vec2.multiply(t,t,cc.v2(this.polygonScale,this.polygonScale));cc.Vec2.add(s,s,l),i.setPosition(s),e.isOnBoard=!0,o&&this.scheduleOnce(function(){i.stopAllActions();var e=n.hintPolygonObjects.length-n.hintPolygonObjects.length;-1!=e&&n.ActiveLevelSaveData.hintsDisplayed.splice(e,1),n.hintPolygonObjects.pop(),i.removeFromParent()},10)},t.prototype.TryStartDraggingPolygonOnBoard=function(e){var t=cc.v2();t=this.boardContainer.convertToNodeSpaceAR(e);var o=cc.Vec2.add(t,t,cc.v2(this.boardContainer.getBoundingBox().size.width/2,this.boardContainer.getBoundingBox().size.height/2)),n=this.GetSelectedPolygonOnBoard(cc.v2(o.x/this.polygonScale,o.y/this.polygonScale));return null!=n&&(n.isOnBoard=!1,this.SetPolygonObjectAsActive(n,e),!0)},t.prototype.GetSelectedPolygonOnBoard=function(e){for(var t=0;t<this.polygonObjects.length;t++){var o=this.polygonObjects[t];if(o.isOnBoard)for(var n=this.activeLevelData.PolygonDatas[o.index],i=0;i<n.triangles.length;i++){var a=n.triangles[i],r=cc.v2();cc.Vec2.add(r,a.p1,o.gridPosition);var c=cc.v2();cc.Vec2.add(c,a.p2,o.gridPosition);var l=cc.v2();if(cc.Vec2.add(l,a.p3,o.gridPosition),this.IsPointInTriangle(e,r,c,l))return o}}return null},a([d({type:cc.Prefab})],t.prototype,"polygonImagePrefab",void 0),a([d({type:cc.Node})],t.prototype,"boardContainer",void 0),a([d({type:cc.Node})],t.prototype,"polygonContainer",void 0),a([d(l.default)],t.prototype,"soundManager",void 0),a([d(cc.Node)],t.prototype,"hintBtn",void 0),a([d(cc.Node)],t.prototype,"resetBtn",void 0),a([d(cc.SpriteFrame)],t.prototype,"beginner_sprite",void 0),a([d(cc.SpriteFrame)],t.prototype,"beginner_sprite_1",void 0),a([d(cc.SpriteFrame)],t.prototype,"easy_sprite",void 0),a([d(cc.SpriteFrame)],t.prototype,"easy_sprite_1",void 0),a([d(cc.SpriteFrame)],t.prototype,"medium_sprite",void 0),a([d(cc.SpriteFrame)],t.prototype,"medium_sprite_1",void 0),a([d(cc.SpriteFrame)],t.prototype,"hard_sprite",void 0),a([d(cc.SpriteFrame)],t.prototype,"hard_sprite_1",void 0),a([d(cc.SpriteFrame)],t.prototype,"expert_sprite",void 0),a([d(cc.SpriteFrame)],t.prototype,"expert_sprite_1",void 0),a([d({type:r.default})],t.prototype,"gameManager",void 0),a([p],t)}(cc.Component);o.default=h;var u=function(){this.index=0,this.polygonImage=null,this.polygonContainerMarker=null,this.isOnBoard=!1,this.gridPosition=cc.Vec2.ZERO};cc._RF.pop()},{"../../Framework/Scripts/Sound/SoundManager":"SoundManager","../../Framework/Scripts/Utilities/ObjectPool":"ObjectPool","./GameManager":"GameManager"}],GameManager:[function(e,t,o){"use strict";cc._RF.push(t,"da366vswkhGh5tHXgD/asPw","GameManager");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,i,a=o.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)r.push(n.value)}catch(c){i={error:c}}finally{try{n&&!n.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}return r},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(o,"__esModule",{value:!0});var l=e("../Data/Inspector/BundleInfo"),s=e("../Data/Inspector/PackInfo"),p=e("../Data/Game/LevelSaveData"),d=e("../../Framework/Scripts/Popup/PopupManager"),h=e("../Screen/GameScreen"),u=e("./GameArea"),v=e("../../Framework/Scripts/Sound/SoundManager"),g=e("../Screen/BundleScreen"),y=e("../Screen/LevelListScreen"),f=cc._decorator,m=f.ccclass,L=f.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bundleInfos=[],t.packListPrefab=null,t.levelFile=null,t.uidFile=null,t.gameScreenNode=null,t.popUpNode=null,t.soundManager=null,t.unlockedPacks=[],t.levelSaveDatas=new Map([]),t.basicBeginnerArr=[],t.basicEasyArr=[],t.basicMediumArr=[],t.basicHardArr=[],t.basicExpertArr=[],t.bundleScreen=null,t.levelListScreen=null,t.gameAreaNode=null,t}var o;return i(t,e),o=t,Object.defineProperty(t.prototype,"BundleInfos",{get:function(){return this.bundleInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ActivePackInfo",{get:function(){return this.activePackInfo},set:function(e){this.activePackInfo=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ActiveLevelData",{get:function(){return this.activeLevelData},set:function(e){this.activeLevelData=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ActiveLevelSaveData",{get:function(){return this.activeLevelSaveData},set:function(e){this.activeLevelSaveData=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NumLevelsCompleted",{get:function(){return this.numLevelsCompleted},set:function(e){this.numLevelsCompleted=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LastAdTimeStamp",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IsActiveDataAvailable",{get:function(){return null!=this.ActivePackInfo&&null!=this.ActiveLevelData&&null!=this.ActiveLevelSaveData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LevelFileText",{get:function(){return this.levelFileText||null==this.levelFile||(this.levelFileText=this.levelFile.json,this.levelFile=null),this.levelFileText},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"UIDFileText",{get:function(){return this.uidFileText||null==this.uidFile||(this.uidFileText=this.uidFile.json,this.uidFile=null),this.uidFileText},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.deviceWidth=cc.view.getFrameSize().width,this.deviceHeight=cc.view.getFrameSize().height,this.deviceHeight/this.deviceWidth<1.5?(this.node.parent.children[3].getComponent(cc.Canvas).fitHeight=!0,this.node.parent.children[3].getComponent(cc.Canvas).fitWidth=!0):(this.node.parent.children[3].getComponent(cc.Canvas).fitHeight=!1,this.node.parent.children[3].getComponent(cc.Canvas).fitWidth=!0)},t.prototype.onLoad=function(){this.ParseLevelFile();var e=this.encryptString("packLastCompletedLevel","pack_lastCompletedLevel_enc"),t=this.encryptString("packLastCompletedLevel","pack_lastCompletedLevelTemp_enc");null!=JSON.parse(cc.sys.localStorage.getItem(e))?o.packLastCompletedLevel=this.decryptMap(new Map(JSON.parse(cc.sys.localStorage.getItem(e))),"pack_lastCompletedLevel_enc"):o.packLastCompletedLevel=new Map([]),null!=JSON.parse(cc.sys.localStorage.getItem(t))?o.packLastCompletedLevelTemp=this.decryptMap(new Map(JSON.parse(cc.sys.localStorage.getItem(t))),"pack_lastCompletedLevelTemp_enc"):o.packLastCompletedLevelTemp=new Map([]),this.levelSaveDatas=new Map([]);for(var n=[],i=0;i<5;i++){var a=new s.default;0==i?(a.packId="basic_beginner",a.packName="BEGINNER",a.packDescription="4 TO 5 POLYGONS",a.levelFiles=this.basicBeginnerArr,a.CreateLevelDatas(a.levelFiles,this.LevelFileText)):1==i?(a.packId="basic_easy",a.packName="EASY",a.packDescription="6 TO 7 POLYGONS",a.levelFiles=this.basicEasyArr,a.CreateLevelDatas(a.levelFiles,this.LevelFileText)):2==i?(a.packId="basic_medium",a.packName="MEDIUM",a.packDescription="8 TO 9 POLYGONS",a.levelFiles=this.basicMediumArr,a.CreateLevelDatas(a.levelFiles,this.LevelFileText)):3==i?(a.packId="basic_hard",a.packName="HARD",a.packDescription="10 TO 11 POLYGONS",a.levelFiles=this.basicHardArr,a.CreateLevelDatas(a.levelFiles,this.LevelFileText)):4==i&&(a.packId="basic_expert",a.packName="EXPERT",a.packDescription="12 TO 13 POLYGONS",a.levelFiles=this.basicExpertArr,a.CreateLevelDatas(a.levelFiles,this.LevelFileText)),n.push(a)}var r=new l.default;r.bundleName="BASIC",r.packListItemPrefab=this.packListPrefab,r.packInfos=n,this.bundleInfos=[r]},t.prototype.onDestroy=function(){this.Save()},t.prototype.ParseLevelFile=function(){this.LevelFileText;var e=this.UIDFileText;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=e[t];if(t.startsWith("BEGIN"))for(var n in o)if(Object.prototype.hasOwnProperty.call(o,n)){var i=o[n];this.basicBeginnerArr.push(i.UID)}if(t.startsWith("EASY"))for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=o[n],this.basicEasyArr.push(i.UID));if(t.startsWith("MEDIUM"))for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=o[n],this.basicMediumArr.push(i.UID));if(t.startsWith("HARD"))for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=o[n],this.basicHardArr.push(i.UID));if(t.startsWith("EXPERT"))for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=o[n],this.basicExpertArr.push(i.UID))}},t.prototype.StartLevel=function(e,t){this.ActivePackInfo=e,this.ActiveLevelData=t,this.ActiveLevelSaveData=this.GetLevelSaveData(t)},t.prototype.NextLevel=function(e){var t=this;if(this.IsActiveDataAvailable)if(e<this.ActivePackInfo.LevelDatas.length)this.StartLevel(this.ActivePackInfo,this.ActivePackInfo.LevelDatas[e]);else{var o=0;this.bundleScreen.getComponent(g.default).packListItemArr.forEach(function(e,n){e.Data==t.ActivePackInfo&&(o=n)});var n=this.bundleScreen.getComponent(g.default).packListItemArr[o+1].Data;this.ActivePackInfo=n,this.StartLevel(this.ActivePackInfo,this.ActivePackInfo.LevelDatas[0]),this.levelListScreen.getComponent(y.default).UpdateList(n)}},t.prototype.ReplayLevel=function(e){this.IsActiveDataAvailable&&e<this.ActivePackInfo.LevelDatas.length&&this.StartLevel(this.ActivePackInfo,this.ActivePackInfo.LevelDatas[e])},t.prototype.TryUseHint=function(){var e;if(!this.IsActiveDataAvailable)return!1;var t=[];e:for(var o=0;o<this.ActiveLevelData.PolygonDatas.length;o++)if(!this.ActiveLevelSaveData.hintsDisplayed.includes(o)){var n=this.ActiveLevelData.PolygonDatas[o];if(c(this.ActiveLevelSaveData.placedPositions.keys()).includes(o))for(var i=cc.v2(),a=0;a<this.ActiveLevelData.PolygonDatas.length;a++)if(this.activeLevelSaveData.placedPositions.has(a)&&(i=this.activeLevelSaveData.placedPositions.get(a),cc.Vec2.equals(i,cc.v2(n.gridBounds.x,n.gridBounds.y))))continue e;t.push(o)}return 0!=t.length&&(e=t[cc.misc.clampf(Math.floor(Math.random()*t.length),0,t.length-1)],this.ActiveLevelSaveData.hintsDisplayed.push(e),this.gameScreenNode.getComponent(h.default).polygonIndex=e,!0)},t.prototype.PolygonPlacedOnBoard=function(e,t,o,n){this.IsActiveDataAvailable&&(this.ActiveLevelSaveData=o,this.ActiveLevelData=n,this.ActiveLevelSaveData.placedPositions.set(e,cc.v2(t.x,t.y)),this.ActiveLevelSaveData.placedPositions.size==this.ActiveLevelData.PolygonDatas.length&&(this.soundManager.levelCompleteSound(),this.ActiveLevelCompleted()),9035==n.LevelIndex&&this.ActiveLevelSaveData.placedPositions.size==this.ActiveLevelData.PolygonDatas.length-1&&(this.soundManager.levelCompleteSound(),this.ActiveLevelCompleted()))},t.prototype.PolygonRemovedFromBoard=function(e,t,o){this.IsActiveDataAvailable&&(this.ActiveLevelSaveData=t,this.ActiveLevelData=o,this.ActiveLevelSaveData.placedPositions.delete(e))},t.prototype.ResetActiveLevel=function(){this.IsActiveDataAvailable&&(this.ActiveLevelSaveData.hintsDisplayed.length=0,this.ActiveLevelSaveData.placedPositions.clear(),this.gameAreaNode.getComponent(u.default).boardContainer.children[0].destroyAllChildren())},t.IsLevelCompleted=function(e){return!!o.packLastCompletedLevelTemp.has(e.Id)&&o.packLastCompletedLevelTemp.has(e.Id)},t.IsLevelLocked=function(e){return e.LevelIndex>0&&(!o.packLastCompletedLevel.has(e.PackId)||e.LevelIndex>o.packLastCompletedLevel.get(e.PackId)+1)},t.prototype.IsPackLocked=function(){return!1},t.prototype.TryUnlockPackWithCoins=function(){return!1},t.GetNumCompletedLevels=function(e){if(!o.packLastCompletedLevel.has(e.packId))return 0;var t=[];return Array.from(o.packLastCompletedLevelTemp.keys()).filter(function(o){o.includes(e.packId)&&t.push(o)}),t.length},t.prototype.GetPackProgress=function(e){return Number(o.GetNumCompletedLevels(e))/Number(e.levelFiles.length)},t.prototype.GetLevelSaveData=function(e){return this.CreateLevelSaveData(e)},t.prototype.CreateLevelSaveData=function(e){var t=new p.default(e);return this.levelSaveDatas.set(e.Id,t),t},t.prototype.ActiveLevelCompleted=function(){var e=o.packLastCompletedLevelTemp.has(this.ActiveLevelData.Id)?o.packLastCompletedLevelTemp.get(this.ActiveLevelData.Id):-1,t=this.ActiveLevelData.LevelIndex>e;this.NumLevelsCompleted,this.NumLevelsCompleted,t&&this.NumLevelsCompleted++,this.SetLevelComplete(this.ActiveLevelData),this.levelSaveDatas.delete(this.ActiveLevelData.Id),this.ActiveLevelData.LevelIndex,this.ActivePackInfo.LevelDatas.length,this.popUpNode.getComponent(d.default).show(),this.gameAreaNode.getComponent(u.default).OnActiveLevelCompleted()},t.prototype.SetLevelComplete=function(e){var t=o.packLastCompletedLevelTemp.has(e.Id)?o.packLastCompletedLevelTemp.get(e.Id):-1;if(e.LevelIndex>t){o.packLastCompletedLevel.set(e.PackId,e.LevelIndex),o.packLastCompletedLevelTemp.set(e.Id,e.LevelIndex);var n=this.encryptString("packLastCompletedLevel","pack_lastCompletedLevel_enc"),i=this.encryptString("packLastCompletedLevel","pack_lastCompletedLevelTemp_enc");cc.sys.localStorage.setItem(n,JSON.stringify(Array.from(this.encryptmap(o.packLastCompletedLevel,"pack_lastCompletedLevel_enc")))),cc.sys.localStorage.setItem(i,JSON.stringify(Array.from(this.encryptmap(o.packLastCompletedLevelTemp,"pack_lastCompletedLevelTemp_enc"))))}},t.prototype.encryptString=function(e,t){var o;e=e.toString();for(var n=0,i=0,a=t.length;i<a;i++)n+=t.charCodeAt(i);e+=t,o=String.fromCharCode(e.charCodeAt(0)+e.length*n);for(var r=1;r<e.length;r++)o+=String.fromCharCode(e.charCodeAt(r)+e.charCodeAt(r-1));return encodeURIComponent(o)},t.prototype.encryptmap=function(e,t){for(var o=new Map,n=0;n<e.size;n++){for(var i=Array.from(e.keys())[n].toString(),a=Array.from(e.values())[n].toString(),r=0,c=0,l=t.length;c<l;c++)r+=t.charCodeAt(c);i+=t,a+=t;for(var s=String.fromCharCode(i.charCodeAt(0)+i.length*r),p=String.fromCharCode(a.charCodeAt(0)+a.length*r),d=1;d<i.length;d++)s+=String.fromCharCode(i.charCodeAt(d)+i.charCodeAt(d-1));for(var h=1;h<a.length;h++)p+=String.fromCharCode(a.charCodeAt(h)+a.charCodeAt(h-1));var u=encodeURIComponent(s),v=encodeURIComponent(p);o.set(u,v)}return o},t.prototype.decryptMap=function(e,t){for(var n=new Map,i=0;i<e.size;i++){for(var a=Array.from(e.keys())[i].toString(),r=Array.from(e.values())[i].toString(),c=0,l=0,s=t.length;l<s;l++)c+=t.charCodeAt(l);try{a=decodeURIComponent(a),r=decodeURIComponent(r)}catch(m){var p=this.encryptString("packLastCompletedLevel","pack_lastCompletedLevel_enc"),d=this.encryptString("packLastCompletedLevel","pack_lastCompletedLevelTemp_enc");return window.localStorage.removeItem(p),window.localStorage.removeItem(d),o.packLastCompletedLevel=new Map([]),o.packLastCompletedLevelTemp=new Map([]),new Map([])}for(var h=String.fromCharCode(a.charCodeAt(0)-a.length*c),u=String.fromCharCode(r.charCodeAt(0)-r.length*c),v=1;v<a.length;v++)h+=String.fromCharCode(a.charCodeAt(v)-h.charCodeAt(v-1));for(var g=1;g<r.length;g++)u+=String.fromCharCode(r.charCodeAt(g)-u.charCodeAt(g-1));var y=h.slice(0,h.length-t.length),f=u.slice(0,u.length-t.length);n.set(y,Number(f))}return n},t.prototype.Save=function(){var e={};return e.unlocked_packs=new Array(this.unlockedPacks.length),e.last_completed=this.SaveLastCompleteLevels(),e.level_save_datas=this.SaveLevelDatas(),e.num_levels_completed=this.NumLevelsCompleted,e},t.prototype.SaveLastCompleteLevels=function(){var e=new Array;return o.packLastCompletedLevelTemp.forEach(function(t,o){var n={};n.pack_id=o,n.last_completed_level=t,e.push(n)}),e},t.prototype.SaveLevelDatas=function(){var e=new Array;return this.levelSaveDatas.forEach(function(t,o){var n={};n.id=o,n.data=t.Save(),e.push(n)}),e},t.prototype.LoadSave=function(){return!0},t.prototype.OnApplicationPause=function(e){e&&this.Save()},t.packLastCompletedLevel=new Map([]),t.packLastCompletedLevelTemp=new Map([]),a([L({type:l.default,serializable:!1})],t.prototype,"bundleInfos",void 0),a([L(cc.Prefab)],t.prototype,"packListPrefab",void 0),a([L({type:cc.JsonAsset})],t.prototype,"levelFile",void 0),a([L({type:cc.JsonAsset})],t.prototype,"uidFile",void 0),a([L(cc.Node)],t.prototype,"gameScreenNode",void 0),a([L(cc.Node)],t.prototype,"popUpNode",void 0),a([L(v.default)],t.prototype,"soundManager",void 0),a([L],t.prototype,"BundleInfos",null),a([L],t.prototype,"ActivePackInfo",null),a([L],t.prototype,"ActiveLevelData",null),a([L],t.prototype,"ActiveLevelSaveData",null),a([L],t.prototype,"NumLevelsCompleted",null),a([L],t.prototype,"LastAdTimeStamp",null),a([L],t.prototype,"IsActiveDataAvailable",null),a([L(cc.Node)],t.prototype,"bundleScreen",void 0),a([L(cc.Node)],t.prototype,"levelListScreen",void 0),a([L(cc.Node)],t.prototype,"gameAreaNode",void 0),o=a([m],t)}(cc.Component);o.default=S,cc._RF.pop()},{"../../Framework/Scripts/Popup/PopupManager":"PopupManager","../../Framework/Scripts/Sound/SoundManager":"SoundManager","../Data/Game/LevelSaveData":"LevelSaveData","../Data/Inspector/BundleInfo":"BundleInfo","../Data/Inspector/PackInfo":"PackInfo","../Screen/BundleScreen":"BundleScreen","../Screen/GameScreen":"GameScreen","../Screen/LevelListScreen":"LevelListScreen","./GameArea":"GameArea"}],GameScreen:[function(e,t,o){"use strict";cc._RF.push(t,"03a0aTF8UhIMYRlwbJj/EQ+","GameScreen");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Game/GameArea"),c=e("../Game/GameManager"),l=e("./LevelListScreen"),s=e("../../Framework/Scripts/Sound/SoundManager"),p=cc._decorator,d=p.ccclass,h=p.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameAreaNode=null,t.levelListScreen=null,t.gameManagerNode=null,t.soundManager=null,t.howToPlayBtn=null,t}var o;return i(t,e),o=t,t.prototype.OnResetClicked=function(){this.soundManager.buttonClickSound(),this.gameManagerNode.getComponent(c.default).ResetActiveLevel(),this.SetupGameArea()},t.prototype.OnHintClicked=function(){this.initt(),o.numberOfHints<2&&this.gameManagerNode.getComponent(c.default).TryUseHint()&&(this.soundManager.hintSound(),this.gameAreaNode.getComponent(r.default).DisplayHint(this.polygonIndex),o.numberOfHints++)},t.prototype.initt=function(){},t.prototype.OnLevelStarted=function(e){this.howToPlayBtn.active=!0,this.howToPlayBtn.parent.getChildByName("SoundBtn").active=!1,this.levelListScreen.headerTextNode.getComponent(cc.Label).string="LEVEL "+e,this.SetupGameArea()},t.prototype.SetupGameArea=function(){var e=this.gameManagerNode.getComponent(c.default).ActiveLevelData,t=this.gameManagerNode.getComponent(c.default).ActiveLevelSaveData;this.gameAreaNode.getComponent(r.default).activeLevelData=null,this.gameAreaNode.getComponent(r.default).boardContainer.children.length=0,this.gameAreaNode.getComponent(r.default).polygonContainer.children.length=0,null!=e&&null!=t&&(this.gameAreaNode.getComponent(r.default).Initialize(),this.gameAreaNode.getComponent(r.default).SetupLevel(e,t))},t.numberOfHints=0,a([h({type:cc.Node})],t.prototype,"gameAreaNode",void 0),a([h(l.default)],t.prototype,"levelListScreen",void 0),a([h(cc.Node)],t.prototype,"gameManagerNode",void 0),a([h(s.default)],t.prototype,"soundManager",void 0),a([h(cc.Node)],t.prototype,"howToPlayBtn",void 0),o=a([d],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Framework/Scripts/Sound/SoundManager":"SoundManager","../Game/GameArea":"GameArea","../Game/GameManager":"GameManager","./LevelListScreen":"LevelListScreen"}],LevelData:[function(e,t,o){"use strict";cc._RF.push(t,"d0c61+eEvROJq8G4WbtfHOJ","LevelData");var n=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,c=e("./PolygonData"),l=e("./TriangleData"),s=function(){function e(e,t,o){this.levelFile=null,this.isLevelFileParsed=!1,this.timestamp="",this.gridSize=0,this.polygonDatas=[],this.Id="",this.PackId="",this.LevelIndex=0,this.levelFile=e,this.PackId=t,this.LevelIndex=o,this.Id=t+"_"+o}return Object.defineProperty(e.prototype,"Timestamp",{get:function(){return this.isLevelFileParsed||this.ParseLevelFile(),this.timestamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"GridSize",{get:function(){return this.isLevelFileParsed||this.ParseLevelFile(),this.gridSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"PolygonDatas",{get:function(){return this.isLevelFileParsed||this.ParseLevelFile(),this.polygonDatas},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LevelFileText",{get:function(){return this.levelFileText||null==this.levelFile||(this.levelFileText=this.levelFile),this.levelFileText},enumerable:!1,configurable:!0}),e.prototype.ParseLevelFile=function(){var e=this,t=this.LevelFileText;this.levelIndex=this.LevelIndex.toString(),null!=t&&(this.timestamp=t.timestamp,this.gridSize=t.grid_size,this.polygonDatas=new Array,t.polygons.forEach(function(t){var o=new c.default;e.ParsePolygonBounds(o,t.bounds),e.ParsePolygonTriangles(o,t.triangle_points),e.polygonDatas.push(o)})),this.isLevelFileParsed=!0},e.prototype.ParsePolygonBounds=function(e,t){var o=new cc.Vec2(t[0],t[1]),n=new cc.Vec2(t[2],t[3]);e.gridBounds=new cc.Rect(o.x,o.y,n.x,n.y)},e.prototype.ParsePolygonTriangles=function(e,t){for(var o=new Array,n=new Array,i=0;i<t.length;i+=6){var a=new cc.Vec2(t[i],t[i+1]),r=new cc.Vec2(t[i+2],t[i+3]),c=new cc.Vec2(t[i+4],t[i+5]),s=new l.default(a,r,c);o.push(s),n.includes(s.p1,0)||n.push(s.p1),n.includes(s.p2,0)||n.push(s.p2),n.includes(s.p3,0)||n.push(s.p3)}e.triangles=o,e.vertices=n},n([r({type:Object})],e.prototype,"levelFile",void 0),n([a],e)}();o.default=s,cc._RF.pop()},{"./PolygonData":"PolygonData","./TriangleData":"TriangleData"}],LevelListItem:[function(e,t,o){"use strict";cc._RF.push(t,"2248eFpexRGe6s+3k+mJoHv","LevelListItem");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,l=r.property,s=e("../Game/GameManager"),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelNumberText=null,t.playIcon=null,t.completeIcon=null,t.lockedIcon=null,t.completedSprite=null,t.currentLevelSprite=null,t.pressedSprite=null,t.camNode=null,t}return i(t,e),Object.defineProperty(t.prototype,"Index",{get:function(){return this.index},set:function(e){this.index=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Data",{get:function(){return this.data},set:function(e){this.data=e},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.lockedIcon.parent.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.lockedIcon.parent.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.lockedIcon.parent.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.lockedIcon.parent.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)},t.prototype.onTouchStart=function(){this.levelNumberText.node.color=cc.color(27,106,251)},t.prototype.onTouchEnd=function(){this.levelNumberText.node.color=cc.Color.WHITE},t.prototype.onTouchMove=function(e){var t=this.camNode.getScreenToWorldPoint(cc.v2(e.getLocation().x,e.getLocation().y)),o=this.node.parent.convertToNodeSpaceAR(cc.v2(t.x,t.y));this.node.getBoundingBox().contains(o)?this.levelNumberText.node.color=cc.color(27,106,251):this.levelNumberText.node.color=cc.Color.WHITE},t.prototype.Setup=function(e,t){(4==e.LevelIndex.toString().length?Number(e.LevelIndex.toString().slice(0,1))%2==0:Number(e.LevelIndex.toString().slice(0,2))%2==0)?4==e.LevelIndex.toString().length?this.levelNumberText.string="0"==(e.LevelIndex+t/2+1).toString().slice(1,2)?(e.LevelIndex+t/2+1).toString().slice(2).toString():(e.LevelIndex+t/2+1).toString().slice(1).toString():this.levelNumberText.string="0"==(e.LevelIndex+t/2+1).toString().slice(2,3)?(e.LevelIndex+t/2+1).toString().slice(3).toString():(e.LevelIndex+t/2+1).toString().slice(2).toString():this.levelNumberText.string=(e.LevelIndex+1).toString().slice(2).toString(),s.default.IsLevelCompleted(e)?this.SetCompleted():s.default.IsLevelLocked(e)?1e3!=e.LevelIndex&&3e3!=e.LevelIndex&&5e3!=e.LevelIndex&&7e3!=e.LevelIndex&&9e3!=e.LevelIndex&&this.SetLocked():this.SetPlayable()},t.prototype.SetCompleted=function(){this.lockedIcon.parent.getComponent(cc.Button).enabled=!0,this.levelNumberText.node.color=cc.Color.WHITE,this.playIcon.active=!1,this.lockedIcon.parent.getComponent(cc.Button).target=this.completeIcon,this.lockedIcon.parent.getComponent(cc.Button).normalSprite=this.completedSprite,this.lockedIcon.parent.getComponent(cc.Button).pressedSprite=this.pressedSprite,this.completeIcon.active=!0,this.lockedIcon.active=!1},t.prototype.SetLocked=function(){this.playIcon.active=!1,this.completeIcon.active=!1,this.lockedIcon.parent.getComponent(cc.Button).enabled=!1,this.lockedIcon.active=!0},t.prototype.SetPlayable=function(){this.lockedIcon.parent.getComponent(cc.Button).enabled=!0,this.levelNumberText.node.color=cc.Color.WHITE,this.lockedIcon.parent.getComponent(cc.Button).target=this.playIcon,this.lockedIcon.parent.getComponent(cc.Button).normalSprite=this.currentLevelSprite,this.lockedIcon.parent.getComponent(cc.Button).pressedSprite=this.pressedSprite,this.playIcon.active=!0,this.completeIcon.active=!1,this.lockedIcon.active=!1},a([l({type:cc.Label})],t.prototype,"levelNumberText",void 0),a([l({type:cc.Node})],t.prototype,"playIcon",void 0),a([l({type:cc.Node})],t.prototype,"completeIcon",void 0),a([l({type:cc.Node})],t.prototype,"lockedIcon",void 0),a([l(cc.SpriteFrame)],t.prototype,"completedSprite",void 0),a([l(cc.SpriteFrame)],t.prototype,"currentLevelSprite",void 0),a([l(cc.SpriteFrame)],t.prototype,"pressedSprite",void 0),a([l],t.prototype,"Index",null),a([l],t.prototype,"Data",null),a([l(cc.Camera)],t.prototype,"camNode",void 0),a([c],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../Game/GameManager":"GameManager"}],LevelListScreen:[function(e,t,o){"use strict";cc._RF.push(t,"4a2d5lEHtxMspKvCIgz2k9y","LevelListScreen");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../UI/LevelListItem"),c=e("../../Framework/Scripts/Popup/PopupManager"),l=e("../../Framework/Scripts/UI/RecyclableListHandler"),s=e("../../Framework/Scripts/Screen/ScreenManager"),p=e("./GameScreen"),d=e("../Game/GameManager"),h=cc._decorator,u=h.ccclass,v=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelListItemPrefab=null,t.levelListContainer=null,t.levelListScrollRect=null,t.packNameText=null,t.cam=null,t.headerTextNode=null,t.difficultyTextNode=null,t.levelScreen=null,t.gameScreen=null,t.screenManagerNode=null,t.popUpNode=null,t.gameManagerNode=null,t}var o;return i(t,e),o=t,t.prototype.OnListScrolled=function(e,t){10!=t&&this.levelListHandler.UpdateList()},t.prototype.start=function(){this.headerTextNode.active=!0,this.headerTextNode.getComponent(cc.Label).string=this.levelScreen.getComponent(o).packNameText.string},t.prototype.OnButtonPressed=function(e){p.default.numberOfHints=0,this.ActiveLevelData=this.currentPackInfo.levelDatas[e.currentTarget.getComponent(r.default).Index],this.popUpNode.getComponent(c.default).currentLevelIndex=e.currentTarget.getComponent(r.default).Index+1,this.levelListHandler.UpdateList(!1),this.levelScreen.active=!1,this.headerTextNode.y=-57,this.difficultyTextNode.active=!1,this.screenManagerNode.getComponent(s.default).soundManager.buttonClickSound(),this.gameManagerNode.getComponent(d.default).StartLevel(this.currentPackInfo,this.ActiveLevelData);var t=String(e.currentTarget.getComponent(r.default).Index+1);this.gameScreen.getComponent(p.default).OnLevelStarted(t),this.gameScreen.active=!0,this.screenManagerNode.getComponent(s.default).backStack.push(this.gameScreen)},t.prototype.UpdateList=function(e){this.levelListHandler&&this.levelListHandler.Refresh();var t=e;if(this.currentPackInfo!=t){this.currentPackInfo=e;var n=new cc.Component.EventHandler;n.target=this.node,n.component="LevelListScreen",n.handler="OnListScrolled",this.levelListScrollRect.scrollEvents.push(n);var i=new cc.Component.EventHandler;i.target=this.node,i.component="LevelListScreen",i.handler="OnButtonPressed",this.levelListItemPrefab.data.getComponent(cc.Button).clickEvents.push(i),this.levelListItemPrefab.data.getComponent(r.default).camNode=this.cam,this.packNameText.string=e.packName,this.headerTextNode.getComponent(cc.Label).string=this.levelScreen.getComponent(o).packNameText.string,null==this.levelListHandler?(this.levelListHandler=new l.default(e.LevelDatas,this.levelListItemPrefab,this.levelListContainer,this.levelListScrollRect),this.levelListHandler.Setup()):this.levelListHandler.UpdateDataObjects(e.LevelDatas)}},a([v({type:cc.Prefab})],t.prototype,"levelListItemPrefab",void 0),a([v({type:cc.Node})],t.prototype,"levelListContainer",void 0),a([v({type:cc.ScrollView})],t.prototype,"levelListScrollRect",void 0),a([v({type:cc.Label})],t.prototype,"packNameText",void 0),a([v(cc.Camera)],t.prototype,"cam",void 0),a([v(cc.Node)],t.prototype,"headerTextNode",void 0),a([v(cc.Node)],t.prototype,"difficultyTextNode",void 0),a([v(cc.Node)],t.prototype,"levelScreen",void 0),a([v(cc.Node)],t.prototype,"gameScreen",void 0),a([v(cc.Node)],t.prototype,"screenManagerNode",void 0),a([v(cc.Node)],t.prototype,"popUpNode",void 0),a([v(cc.Node)],t.prototype,"gameManagerNode",void 0),o=a([u],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../../Framework/Scripts/Popup/PopupManager":"PopupManager","../../Framework/Scripts/Screen/ScreenManager":"ScreenManager","../../Framework/Scripts/UI/RecyclableListHandler":"RecyclableListHandler","../Game/GameManager":"GameManager","../UI/LevelListItem":"LevelListItem","./GameScreen":"GameScreen"}],LevelSaveData:[function(e,t,o){"use strict";cc._RF.push(t,"1c51dxuCdpDg6mUzLuDaMLA","LevelSaveData");var n=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=(i.property,function(){function e(e,t){this.placedPositions=new Map([]),this.hintsDisplayed=[],this.hintsDisplayed=new Array,this.timestamp=e.Timestamp,t&&this.LoadSave(t)}return e.prototype.Save=function(){var e=new Array;this.placedPositions.forEach(function(t,o){var n={};n.index=o,n.x=t.x,n.y=t.y,e.push(n)});var t={};return t.timestamp=JSON.parse(this.timestamp),t.placed_positions=e,t},e.prototype.LoadSave=function(e){this.timestamp=e.timestamp;var t=e.placed_positions;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var n=(l=t[o]).index,i=l.x,a=l.y;this.placedPositions.set(n,cc.v2(i,a))}var r=e.hints_displayed;for(var c in r)if(Object.prototype.hasOwnProperty.call(r,c))var l=r[c]},n([a],e)}());o.default=r,cc._RF.pop()},{}],ObjectPool:[function(e,t,o){"use strict";cc._RF.push(t,"72209CPgElLT7XLOai8Z6cv","ObjectPool");var n=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./PoolObject"),a=cc._decorator,r=a.ccclass,c=(a.property,function(){function e(e,t,o){void 0===o&&(o=null),this.objectPrefab=null,this.poolObjects=new Array,this.parent=null,this.objectPrefab=e,this.parent=o;for(var n=0;n<t;n++)this.CreateObject()}return e.CreatePoolContainer=function(e,t){void 0===t&&(t="pool_container");var o=new cc.Node(t);return o.active=!0,"pool_container"==t&&(o.active=!1),o.parent=e,o},e.ReturnObjectToPool=function(e){var t=e.getComponent(i.default);null!=t&&t.pool.ReturnObjectToPool1(t)},e.ReturnChildObjectsToPool=function(e){for(var t=e.children.length-1;t>=0;t--)this.ReturnObjectToPool(e.children[t])},e.prototype.GetObject1=function(){return this.GetObject2(void 0)},e.prototype.GetObject2=function(){for(var e=null,t=0;t<this.poolObjects.length;t++)if(this.poolObjects[t].isInPool){e=this.poolObjects[t];break}return null==e&&(e=this.CreateObject()),e.node.active=!0,e.isInPool=!1,e.node},e.prototype.GetObject3=function(e){return this.GetObject4(e,void 0)},e.prototype.GetObject4=function(e,t){var o=this.GetObject2(t);return o.parent=e,o},e.prototype.GetObjectPackList=function(e){return this.GetObject3(e).getComponent("PackListItem")},e.prototype.GetObjectLevelItem=function(e,t){return this.GetObject4(e,t).getComponent("LevelListItem")},e.prototype.GetObject=function(){return this.GetObject1().getComponent("PolygonImage")},e.prototype.ReturnAllObjectsToPool=function(){for(var e=0;e<this.poolObjects.length;e++)this.ReturnObjectToPool1(this.poolObjects[e])},e.prototype.ReturnObjectToPool1=function(e){e.node.parent=this.parent,e.node.active=!1},e.prototype.DestroyAllObjects=function(){for(var e=0;e<this.poolObjects.length;e++)this.poolObjects[e].destroy();this.poolObjects.length=0},e.prototype.CreateObject=function(){var e=cc.instantiate(this.objectPrefab),t=e.addComponent(i.default);return t.pool=this,e.parent=this.parent,this.poolObjects.push(t),this.ReturnObjectToPool1(t),t},n([r],e)}());o.default=c,cc._RF.pop()},{"./PoolObject":"PoolObject"}],PackInfo:[function(e,t,o){"use strict";cc._RF.push(t,"c4e61BHFnJGWbge+SPzBe0H","PackInfo");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c=e("../../LevelData"),l=cc._decorator,s=l.ccclass,p=l.property;(function(e){e[e.None=0]="None",e[e.Coins=1]="Coins",e[e.Stars=2]="Stars",e[e.IAP=3]="IAP"})(r||(r={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.packName="BEGINNER",t.levelFiles=[],t.levelDatas=[],t}return i(t,e),Object.defineProperty(t.prototype,"HasLevelDats",{get:function(){return null!=this.levelDatas},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LevelDatas",{get:function(){return this.levelDatas},enumerable:!1,configurable:!0}),t.prototype.CreateLevelDatas=function(e,t){this.levelDatas=new Array;for(var o=t,n=0;n<e.length;n++)this.levelDatas.push(new c.default(o[e[n]],this.packId,e[n]))},a([p],t.prototype,"HasLevelDats",null),a([p],t.prototype,"LevelDatas",null),a([s],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../LevelData":"LevelData"}],PackListItem:[function(e,t,o){"use strict";cc._RF.push(t,"89709kK0bhOg5TKJpo+j3GV","PackListItem");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,l=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nameText=null,t}return i(t,e),Object.defineProperty(t.prototype,"Data",{get:function(){return this.data},set:function(e){this.data=e},enumerable:!1,configurable:!0}),t.prototype.Setup=function(e){this.nameText.string=e.packName},a([l(cc.Label)],t.prototype,"nameText",void 0),a([l],t.prototype,"Data",null),a([c],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],PolygonData:[function(e,t,o){"use strict";cc._RF.push(t,"8cd8cCp/I9Dvqv5EJEDr65d","PolygonData");var n=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=(i.property,function(){function e(){}return n([a],e)}());o.default=r,cc._RF.pop()},{}],PolygonImage:[function(e,t,o){"use strict";cc._RF.push(t,"82dd3aq44RH/Ik+uyflNHzQ","PolygonImage");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,i,a=o.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)r.push(n.value)}catch(c){i={error:c}}finally{try{n&&!n.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}return r},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(o,"__esModule",{value:!0});var l=cc._decorator,s=l.ccclass,p=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.vertices=[],t.uvArray=[],t}return i(t,e),t.prototype.Setup=function(e,t,o,n,i){this.scale=t,this.polygonData=e,this.boardSize=o,this.sizeDelta=cc.v2(e.gridBounds.size.width*t,e.gridBounds.height*t),this.node.width=e.gridBounds.size.width*t,this.node.height=e.gridBounds.size.height*t;var a=this.node.width<this.node.height?o/this.node.width:o/this.node.height;this.scaledTextureSize=new cc.Vec2(this.node.width*a,this.node.height*a),n?this.OnPopulateMesh(170):i?this.OnPopulateMesh(70):this.OnPopulateMesh()},t.prototype.OnPopulateMesh=function(e){if(null!=this.polygonData){var t=this.node.getAnchorPoint().x*this.sizeDelta.x,o=this.node.getAnchorPoint().y*this.sizeDelta.y,n=new cc.Vec2(t,o),i=cc.gfx,a=new i.VertexFormat([{name:i.ATTR_POSITION,type:i.ATTR_TYPE_FLOAT32,num:3},{name:i.ATTR_UV0,type:i.ATTR_TYPE_FLOAT32,num:2},{name:i.ATTR_COLOR,type:i.ATTR_TYPE_UINT8,num:4,normalize:!0}]),r=new cc.Mesh;r.init(a,18,!0);for(var l=0;l<this.polygonData.triangles.length;l++){var s=this.polygonData.triangles[l],p=cc.v2();p=cc.Vec2.multiply(p,s.p1,cc.v2(this.scale,this.scale));var d=cc.v2();d=cc.Vec2.multiply(d,s.p2,cc.v2(this.scale,this.scale));var h=cc.v2();h=cc.Vec2.multiply(h,s.p3,cc.v2(this.scale,this.scale)),this.AddVert(p,n),this.AddVert(d,n),this.AddVert(h,n)}r.setVertices(i.ATTR_POSITION,c(this.vertices));var u=this.node.color;u.a=e||this.node.color.a,r.setVertices(i.ATTR_COLOR,[u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u]),r.setVertices(i.ATTR_UV0,c(this.uvArray)),this.node.getComponent(cc.MeshRenderer).mesh=r}},t.prototype.AddVert=function(e,t){this.GetUV(e),cc.Vec2.subtract(e,e,t),this.vertices.push(e)},t.prototype.GetUV=function(e){var t=e.x+this.polygonData.gridBounds.xMin*this.scale+(this.scaledTextureSize.x-this.boardSize)/2,o=e.y+this.polygonData.gridBounds.yMin*this.scale+(this.scaledTextureSize.y-this.boardSize)/2,n=t/this.scaledTextureSize.x,i=o/this.scaledTextureSize.y;return this.uvArray.push(new cc.Vec2(n,i)),new cc.Vec2(n,i)},a([s],t)}(cc.Component));o.default=p,cc._RF.pop()},{}],PoolObject:[function(e,t,o){"use strict";cc._RF.push(t,"c4360x2VhNKuZ1f/CAbKP51","PoolObject");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,l=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),a([c],t)}(cc.Component));o.default=l,cc._RF.pop()},{}],PopupManager:[function(e,t,o){"use strict";cc._RF.push(t,"3e19brT2b5G25TscTNHYZ1T","PopupManager");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../Script/Screen/GameScreen"),c=e("../Screen/ScreenManager"),l=e("../../../Script/Game/GameManager"),s=cc._decorator,p=s.ccclass,d=s.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelCompletePopup=null,t.nextButton=null,t.gameScreen=null,t.screenManager=null,t.gameManagerNode=null,t.currentLevelIndex=0,t.chkTotalLevels=!1,t}return i(t,e),t.prototype.nextBtnAction=function(){this.showw(),r.default.numberOfHints=0,this.levelCompletePopup.active=!1,this.levelCompletePopup.getChildByName("UIContainer").setScale(.42083333,.42083333),this.gameScreen.active=!1,this.screenManager.getComponent(c.default).soundManager.buttonClickSound(),this.currentLevelIndex==this.gameManagerNode.getComponent(l.default).ActivePackInfo.LevelDatas.length&&(this.chkTotalLevels=!0),this.gameManagerNode.getComponent(l.default).NextLevel(this.currentLevelIndex),this.chkTotalLevels&&(this.chkTotalLevels=!1,this.currentLevelIndex=0),this.gameScreen.getComponent(r.default).OnLevelStarted(String(this.currentLevelIndex+1)),this.gameScreen.active=!0,this.currentLevelIndex++},t.prototype.showw=function(){},t.prototype.replayBtnAction=function(){r.default.numberOfHints=0,this.levelCompletePopup.active=!1,this.levelCompletePopup.getChildByName("UIContainer").setScale(.42083333,.42083333),this.gameScreen.active=!1,this.screenManager.getComponent(c.default).soundManager.buttonClickSound(),this.gameManagerNode.getComponent(l.default).ReplayLevel(this.currentLevelIndex-1),this.gameScreen.getComponent(r.default).OnLevelStarted(String(this.currentLevelIndex)),this.gameScreen.active=!0},t.prototype.closeBtnAction=function(){r.default.numberOfHints=0,this.levelCompletePopup.active=!1,this.levelCompletePopup.getChildByName("UIContainer").setScale(.42083333,.42083333),this.screenManager.getComponent(c.default).backBtnAction()},t.prototype.show=function(){10049!=this.gameManagerNode.getComponent(l.default).ActivePackInfo.levelFiles[this.currentLevelIndex-1]?this.nextButton.active=!0:this.nextButton.active=!1;var e=cc.scaleTo(.15,.52083333,.52083333),t=cc.scaleTo(.15,.48083333,.48083333);this.levelCompletePopup.active=!0,cc.tween(this.levelCompletePopup.getChildByName("UIContainer")).delay(.1).sequence(e,t).start()},a([d(cc.Node)],t.prototype,"levelCompletePopup",void 0),a([d(cc.Node)],t.prototype,"nextButton",void 0),a([d(cc.Node)],t.prototype,"gameScreen",void 0),a([d(cc.Node)],t.prototype,"screenManager",void 0),a([d(cc.Node)],t.prototype,"gameManagerNode",void 0),a([p],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../Script/Game/GameManager":"GameManager","../../../Script/Screen/GameScreen":"GameScreen","../Screen/ScreenManager":"ScreenManager"}],RecyclableListHandler:[function(e,t,o){"use strict";cc._RF.push(t,"62677vsrXVBn43oL9Q6t/JB","RecyclableListHandler");var n=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var i=e("../Utilities/ObjectPool"),a=e("../../../Script/UI/LevelListItem"),r=cc._decorator,c=r.ccclass,l=(r.property,function(){function e(e,t,o,n){this.dataObjects=[],this.dataObjects=e,this.listItemPrefab=t,this.listContainer=o,this.listScrollRect=n,this.listItemPool=new i.default(t,0,i.default.CreatePoolContainer(o)),this.listItemPlaceholders=new Array}return e.prototype.UpdateDataObjects=function(e){this.listScrollRect.scrollToTop(0),this.dataObjects=e,this.SyncPlaceholdersObjects(),this.Reset()},e.prototype.Setup=function(){this.SyncPlaceholdersObjects(),this.Reset()},e.prototype.Reset=function(){this.RemoveAllListItems(),this.UpdateList(!0)},e.prototype.Refresh=function(){for(var e=this.topItemIndex;e<=this.bottomItemIndex&&e>=0&&e<this.listItemPlaceholders.length;e++){var t=this.listItemPlaceholders[e];1==t.childrenCount&&t.children[0].getComponent(a.default).Setup(this.dataObjects[e],this.dataObjects.length)}},e.prototype.SyncPlaceholdersObjects=function(){this.listContainer.width=312+3*this.listContainer.getComponent(cc.Layout).spacingX;for(var e=0;e<this.dataObjects.length&&e<this.listItemPlaceholders.length;e++)this.listItemPlaceholders[e].active=!0;for(;this.listItemPlaceholders.length<this.dataObjects.length;){var t=new cc.Node("list_item");t.setParent(this.listContainer),t.width=78,t.height=67.2,this.listItemPlaceholders.push(t)}for(e=this.dataObjects.length;e<this.listItemPlaceholders.length;e++)this.listItemPlaceholders[e].active=!1},e.prototype.RemoveAllListItems=function(){for(var e=0;e<this.listItemPlaceholders.length;e++)this.RemoveListItem(this.listItemPlaceholders[e])},e.prototype.UpdateList=function(e){void 0===e&&(e=!1),e?(this.topItemIndex=0,this.bottomItemIndex=this.FillList(this.topItemIndex,1)):(this.RecycleList(),this.topItemIndex=this.FillList(this.topItemIndex,-1),this.bottomItemIndex=this.FillList(this.bottomItemIndex,1))},e.prototype.FillList=function(e,t){for(var o=e,n=e;n>=0&&n<this.dataObjects.length;n+=t){var i=this.listItemPlaceholders[n];if(!this.IsVisible(n,this.listItemPlaceholders[n]))break;o=n,0==i.childrenCount&&this.AddListItem(n,i,-1==t)}return o},e.prototype.RecycleList=function(){if(0!=this.listItemPlaceholders.length){for(var e=this.topItemIndex;e<=this.bottomItemIndex;e++){var t=this.listItemPlaceholders[e];if(this.IsVisible(e,this.listItemPlaceholders[e]))break;1==t.childrenCount&&(this.RemoveListItem(t),this.topItemIndex++)}for(e=this.bottomItemIndex;e>=this.topItemIndex&&(t=this.listItemPlaceholders[e],!this.IsVisible(e,this.listItemPlaceholders[e]));e--)1==t.childrenCount&&(this.RemoveListItem(t),this.bottomItemIndex--);if(this.topItemIndex>this.bottomItemIndex){var o=this.topItemIndex<this.dataObjects.length?this.topItemIndex:this.bottomItemIndex,n=this.listItemPlaceholders[o],i=this.listContainer.getPosition().y;if(-n.getPosition().y<i){for(e=o;e<this.dataObjects.length;e++)if(this.IsVisible(e,this.listItemPlaceholders[e])){this.topItemIndex=e,this.bottomItemIndex=e;break}}else for(e=o;e>=0;e--)if(this.IsVisible(e,this.listItemPlaceholders[e])){this.topItemIndex=e,this.bottomItemIndex=e;break}}}},e.prototype.IsVisible=function(e,t){var o=this.listScrollRect.node.getChildByName("ViewPort"),n=-t.getPosition().y-t.height/2,i=-t.getPosition().y+t.height/2,a=this.listContainer.getPosition().y;return n<this.listContainer.getPosition().y+o.height&&i>a},e.prototype.AddListItem=function(e,t){var o=this.listItemPool.GetObjectLevelItem(t,void 0),n=this.dataObjects[e];o.Index=e,o.Setup(n,this.dataObjects.length)},e.prototype.RemoveListItem=function(e){if(1==e.childrenCount){var t=e.children[0].getComponent(a.default);i.default.ReturnObjectToPool(t.node)}},n([c],e)}());o.default=l,cc._RF.pop()},{"../../../Script/UI/LevelListItem":"LevelListItem","../Utilities/ObjectPool":"ObjectPool"}],ScreenManager:[function(e,t,o){"use strict";cc._RF.push(t,"abf32bFYPtJYaGkYjsBtmM4","ScreenManager");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../Script/Screen/BundleScreen"),c=e("../../../Script/Screen/LevelListScreen"),l=e("../Sound/SoundManager"),s=e("../../../Script/Game/GameManager"),p=e("../../../Script/Screen/GameScreen"),d=cc._decorator,h=d.ccclass,u=d.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bundleScreenUI=null,t.mainScreenUI=null,t.levelScreen=null,t.gameScreen=null,t.gameManager=null,t.soundManager=null,t.soundSpriteNormal=null,t.soundSpriteNormal_1=null,t.soundSpritePressed=null,t.soundSpritePressed_1=null,t.backButton=null,t.headerTextNode=null,t.backStack=[],t.tutorial=null,t}return i(t,e),t.prototype.onLoad=function(){this.backStack.push(this.mainScreenUI)},t.prototype.show=function(){this.headerTextNode.parent.getComponent(cc.Sprite).enabled=!0,this.soundManager.playSound?this.headerTextNode.parent.getChildByName("SoundBtn").getChildByName("Background").getComponent(cc.Sprite).spriteFrame=this.soundSpriteNormal_1:this.headerTextNode.parent.getChildByName("SoundBtn").getChildByName("Background").getComponent(cc.Sprite).spriteFrame=this.soundSpritePressed_1,this.soundManager.buttonClickSound(),this.mainScreenUI.active=!1,this.bundleScreenUI.active=!0,this.backStack.push(this.bundleScreenUI),this.backButton.active=!0,this.headerTextNode.active=!0},t.prototype.backBtnAction=function(){this.soundManager.buttonClickSound(),this.backStack.length>1&&(this.backStack[this.backStack.length-1].active=!1,this.backStack[this.backStack.length-2].active=!0,"LevelScreen"==this.backStack[this.backStack.length-2].name&&(this.levelScreen.getComponent(c.default).difficultyTextNode.active=!0,this.gameScreen.getComponent(p.default).howToPlayBtn.active=!1,this.headerTextNode.parent.getChildByName("SoundBtn").active=!0,this.headerTextNode.y=-67,this.headerTextNode.getComponent(cc.Label).string=this.levelScreen.getComponent(c.default).packNameText.string,this.levelScreen.getComponent(c.default).UpdateList(this.gameManager.getComponent(s.default).ActivePackInfo)),"BundleScreen"==this.backStack[this.backStack.length-2].name&&(this.levelScreen.getComponent(c.default).difficultyTextNode.active=!1,this.headerTextNode.y=-57,this.headerTextNode.getComponent(cc.Label).string="DIFFICULTY",this.bundleScreenUI.getComponent(r.default).Show()),this.backStack.pop()),1==this.backStack.length&&(this.headerTextNode.parent.getComponent(cc.Sprite).enabled=!1,this.soundManager.playSound?this.headerTextNode.parent.getChildByName("SoundBtn").getChildByName("Background").getComponent(cc.Sprite).spriteFrame=this.soundSpriteNormal:this.headerTextNode.parent.getChildByName("SoundBtn").getChildByName("Background").getComponent(cc.Sprite).spriteFrame=this.soundSpritePressed,this.headerTextNode.active=!1,this.backButton.active=!1)},t.prototype.openTutorial=function(){this.soundManager.buttonClickSound(),this.tutorial.active=!0},a([u({type:cc.Node})],t.prototype,"bundleScreenUI",void 0),a([u({type:cc.Node})],t.prototype,"mainScreenUI",void 0),a([u(cc.Node)],t.prototype,"levelScreen",void 0),a([u(cc.Node)],t.prototype,"gameScreen",void 0),a([u(cc.Node)],t.prototype,"gameManager",void 0),a([u(l.default)],t.prototype,"soundManager",void 0),a([u(cc.SpriteFrame)],t.prototype,"soundSpriteNormal",void 0),a([u(cc.SpriteFrame)],t.prototype,"soundSpriteNormal_1",void 0),a([u(cc.SpriteFrame)],t.prototype,"soundSpritePressed",void 0),a([u(cc.SpriteFrame)],t.prototype,"soundSpritePressed_1",void 0),a([u(cc.Node)],t.prototype,"backButton",void 0),a([u(cc.Node)],t.prototype,"headerTextNode",void 0),a([u(cc.Node)],t.prototype,"tutorial",void 0),a([h],t)}(cc.Component);o.default=v,cc._RF.pop()},{"../../../Script/Game/GameManager":"GameManager","../../../Script/Screen/BundleScreen":"BundleScreen","../../../Script/Screen/GameScreen":"GameScreen","../../../Script/Screen/LevelListScreen":"LevelListScreen","../Sound/SoundManager":"SoundManager"}],SoundManager:[function(e,t,o){"use strict";cc._RF.push(t,"772b8CzB6JLf5RtDHpwU9FI","SoundManager");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,l=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonClick_Sound=null,t.hint_Sound=null,t.levelComplete_Sound=null,t.shapePlaced_Sound=null,t.shapeSelected_Sound=null,t.soundBtn=null,t.soundSprites=[],t.soundSprites_1=[],t.playSound=!0,t}return i(t,e),t.prototype.onLoad=function(){},t.prototype.SoundBtnAction=function(){this.buttonClickSound(),this.playSound=!this.playSound,"sound_on"!=this.soundBtn.getChildByName("Background").getComponent(cc.Sprite).spriteFrame.name&&"sound_off"!=this.soundBtn.getChildByName("Background").getComponent(cc.Sprite).spriteFrame.name||(this.playSound?this.soundBtn.getChildByName("Background").getComponent(cc.Sprite).spriteFrame=this.soundSprites_1[0]:this.soundBtn.getChildByName("Background").getComponent(cc.Sprite).spriteFrame=this.soundSprites_1[1]),"sound_w_on"!=this.soundBtn.getChildByName("Background").getComponent(cc.Sprite).spriteFrame.name&&"sound_w_off"!=this.soundBtn.getChildByName("Background").getComponent(cc.Sprite).spriteFrame.name||(this.playSound?this.soundBtn.getChildByName("Background").getComponent(cc.Sprite).spriteFrame=this.soundSprites[0]:this.soundBtn.getChildByName("Background").getComponent(cc.Sprite).spriteFrame=this.soundSprites[1])},t.prototype.buttonClickSound=function(){this.buttonClick_Sound&&this.playSound&&cc.audioEngine.playEffect(this.buttonClick_Sound,!1)},t.prototype.hintSound=function(){this.hint_Sound&&this.playSound&&cc.audioEngine.playEffect(this.hint_Sound,!1)},t.prototype.levelCompleteSound=function(){this.levelComplete_Sound&&this.playSound&&cc.audioEngine.playEffect(this.levelComplete_Sound,!1)},t.prototype.shapePlacedSound=function(){this.shapePlaced_Sound&&this.playSound&&cc.audioEngine.playEffect(this.shapePlaced_Sound,!1)},t.prototype.shapeSelectedSound=function(){this.shapeSelected_Sound&&this.playSound&&cc.audioEngine.playEffect(this.shapeSelected_Sound,!1)},a([l({type:cc.AudioClip})],t.prototype,"buttonClick_Sound",void 0),a([l(cc.AudioClip)],t.prototype,"hint_Sound",void 0),a([l(cc.AudioClip)],t.prototype,"levelComplete_Sound",void 0),a([l(cc.AudioClip)],t.prototype,"shapePlaced_Sound",void 0),a([l(cc.AudioClip)],t.prototype,"shapeSelected_Sound",void 0),a([l(cc.Node)],t.prototype,"soundBtn",void 0),a([l(cc.SpriteFrame)],t.prototype,"soundSprites",void 0),a([l(cc.SpriteFrame)],t.prototype,"soundSprites_1",void 0),a([c],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],TriangleData:[function(e,t,o){"use strict";cc._RF.push(t,"3ecc2BT945L87YlO24Is06m","TriangleData");var n=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=(i.property,function(){function e(e,t,o){this.p1=e,this.p2=t,this.p3=o;var n=Math.min(e.x,t.x,o.x),i=Math.max(e.x,t.x,o.x),a=Math.min(e.y,t.y,o.y),r=Math.max(e.y,t.y,o.y);this.Bounds=new cc.Rect(n,a,i-n,r-a)}return n([a],e)}());o.default=r,cc._RF.pop()},{}],Tutorial:[function(e,t,o){"use strict";cc._RF.push(t,"bcd42lRXMRBAKSu2TgBI0mE","Tutorial");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,o,r):i(t,o))||r);return a>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Framework/Scripts/Sound/SoundManager"),c=cc._decorator,l=c.ccclass,s=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.doneBtn=null,t.nextBtn=null,t.pageView=null,t.isNotScroll=!1,t.soundManager=null,t}return i(t,e),t.prototype.start=function(){this.isNotScroll||(this.doneBtn=this.node.parent.children[0],this.nextBtn=this.node.parent.children[1],this.pageView=this.node.getComponent(cc.PageView))},t.prototype.OnListScrolled=function(e,t){t==cc.PageView.EventType.PAGE_TURNING&&(this.pageView.getCurrentPageIndex()==this.pageView.getPages().length-1?(this.nextBtn.active=!1,this.doneBtn.active=!0):(this.nextBtn.active=!0,this.doneBtn.active=!1))},t.prototype.Next=function(){this.soundManager.getComponent(r.default).buttonClickSound(),this.pageView.scrollToPage(this.pageView.getCurrentPageIndex()+1,.5),this.pageView.getCurrentPageIndex()==this.pageView.getPages().length-1&&(this.nextBtn.active=!1,this.doneBtn.active=!0)},t.prototype.Done=function(){this.soundManager.getComponent(r.default).buttonClickSound(),this.node.parent.parent.active=!1,this.nextBtn&&(this.nextBtn.active=!0),this.doneBtn&&(this.doneBtn.active=!1),this.pageView&&this.pageView.scrollToPage(0,.5)},a([s],t.prototype,"isNotScroll",void 0),a([s({type:cc.Node})],t.prototype,"soundManager",void 0),a([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../Framework/Scripts/Sound/SoundManager":"SoundManager"}]},{},["PopupManager","ScreenManager","SoundManager","RecyclableListHandler","ObjectPool","PoolObject","LevelSaveData","BundleInfo","PackInfo","GameArea","GameManager","LevelData","PolygonData","BundleScreen","GameScreen","LevelListScreen","TriangleData","Tutorial","LevelListItem","PackListItem","PolygonImage"]);